<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>David Gaines | Creative Director Portfolio</title>
    <meta name="description" content="A personal portfolio website for Creative Director David Gaines, showcasing impact, strategy, leadership, and adaptability through curated case studies and recent work."/>
    <script>
      (function() {
        const path = window.location.pathname;
        const hash = window.location.hash;
        if (path && path !== '/' && !hash) {
          window.location.replace('/#' + path + window.location.search);
        }
      })();
    </script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='10' fill='%230f172a' /><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='Inter, sans-serif' font-size='50' font-weight='900' fill='%23f8fafc'>GD!</text></svg>" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
      body.hide-cursor, body.hide-cursor * {
        cursor: none;
      }
      .text-textured {
        background-image: url('https://images.unsplash.com/photo-1564288819588-6db0b59c4a84?q=80&w=1000&auto=format&fit=crop');
        background-size: cover;
        background-clip: text;
        -webkit-background-clip: text;
        color: transparent;
      }
      /* Style for the sticky header to enable cursor blend effect */
      .header-with-blur::before {
        content: '';
        position: absolute;
        inset: 0;
        z-index: -1;
        background-color: rgba(var(--header-bg-color-rgb, 15, 23, 42), 0.8);
        -webkit-backdrop-filter: blur(12px); /* Corresponds to backdrop-blur-lg */
        backdrop-filter: blur(12px);
      }
      .logo-dragging {
        opacity: 0.5;
        transform: scale(1.05);
        box-shadow: 0 0 20px rgba(8, 145, 178, 0.7);
      }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            },
            colors: {
              'brand-primary': 'var(--brand-primary, #0891b2)', 
              'brand-secondary': 'var(--brand-secondary, #f0f9ff)', 
              'base-dark': '#0f172a', // Slate 900
              'base-medium': '#1e293b', // Slate 800
              'base-light': '#334155', // Slate 700
              'text-primary': '#f8fafc', // Slate 50
              'text-secondary': '#cbd5e1', // Slate 300
              'text-tertiary': '#94a3b8', // Slate 400
            },
            animation: {
              'fade-in-up': 'fade-in-up 0.6s ease-out forwards',
              'infinite-scroll-left': 'infinite-scroll-left 60s linear infinite',
              'infinite-scroll-right': 'infinite-scroll-right 60s linear infinite',
            },
            keyframes: {
              'fade-in-up': {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              },
              'infinite-scroll-left': {
                '0%': { transform: 'translateX(0)' },
                '100%': { transform: 'translateX(-50%)' },
              },
              'infinite-scroll-right': {
                '0%': { transform: 'translateX(-50%)' },
                '100%': { transform: 'translateX(0)' },
              },
            }
          }
        }
      }
    </script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="importmap">
{
  "imports": {
    "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.0/client",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
    "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
    "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
  }
}
</script>
</head>
  <body class="bg-base-dark text-text-primary font-sans">
    <div id="root"></div>
    <script type="text/babel" data-type="module">
import React from 'react';
import ReactDOM from 'react-dom/client';
import { initializeApp } from 'firebase/app';
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'firebase/auth';
import { getFirestore, doc, setDoc, onSnapshot } from 'firebase/firestore';

const { useState, useEffect, createContext, useContext, useRef, Component } = React;

// --- Inlined from constants.ts ---
const CLIENT_LOGOS = [
    'https://logo.clearbit.com/transistor.fm', 'https://logo.clearbit.com/reform.app', 'https://logo.clearbit.com/tuple.app', 'https://logo.clearbit.com/savvycal.com', 'https://logo.clearbit.com/statamic.com', 'https://logo.clearbit.com/google.com', 'https://logo.clearbit.com/laravel.com', 'https://logo.clearbit.com/miragejs.com', 'https://logo.clearbit.com/workcation.com', 'https://logo.clearbit.com/microsoft.com', 'https://logo.clearbit.com/vercel.com', 'https://logo.clearbit.com/github.com', 'https://logo.clearbit.com/meta.com', 'https://logo.clearbit.com/intel.com', 'https://logo.clearbit.com/sentry.io', 'https://logo.clearbit.com/mailchimp.com', 'https://logo.clearbit.com/notion.so', 'https://logo.clearbit.com/atlassian.com', 'https://logo.clearbit.com/asana.com', 'https://logo.clearbit.com/loom.com', 'https://logo.clearbit.com/framer.com', 'https://logo.clearbit.com/figma.com', 'https://logo.clearbit.com/dribbble.com', 'https://logo.clearbit.com/hubspot.com', 'https://logo.clearbit.com/shopify.com', 'https://logo.clearbit.com/intercom.com', 'https://logo.clearbit.com/slack.com', 'https://logo.clearbit.com/stripe.com', 'https://logo.clearbit.com/airbnb.com', 'https://logo.clearbit.com/netflix.com',
];
const BRAND_LOGOS = [
    'https://logo.clearbit.com/sony.com', 'https://logo.clearbit.com/nike.com', 'https://logo.clearbit.com/cocacola.com', 'https://logo.clearbit.com/netflix.com', 'https://logo.clearbit.com/spotify.com', 'https://logo.clearbit.com/playstation.com', 'https://logo.clearbit.com/nintendo.com', 'https://logo.clearbit.com/lego.com', 'https://logo.clearbit.com/redbull.com', 'https://logo.clearbit.com/starbucks.com', 'https://logo.clearbit.com/disney.com', 'https://logo.clearbit.com/amazon.com', 'https://logo.clearbit.com/apple.com', 'https://logo.clearbit.com/tesla.com', 'https://logo.clearbit.com/mcdonalds.com',
];
const HERO_PROJECTS = [
  { id: 'mlb-the-show', title: 'MLB The Show Franchise', subtitle: 'Case Study: Global Brand Launch & Retail Success', client: 'Sony PlayStation', tags: ['Packaging', 'Broadcast TV', 'Retail', 'Trade Show'], heroImage: { url: 'https://picsum.photos/seed/mlb/1200/800', alt: 'MLB The Show promotional image' },
    contentBlocks: [
      { type: 'hero', data: { images: [{ url: 'https://picsum.photos/seed/mlb-footer1/400/1200', alt: 'MLB Footer Image 1' }, { url: 'https://picsum.photos/seed/mlb-footer2/400/1200', alt: 'MLB Footer Image 2' }, { url: 'https://picsum.photos/seed/mlb-footer3/400/1200', alt: 'MLB Footer Image 3' }], style: 'trio' } },
      { type: 'title', data: {} },
      { type: 'text', data: { heading: 'The Challenge', body: 'Launch a new flagship sports gaming franchise to compete against established market giants and capture the attention of a diverse audience, from hardcore baseball fans to casual gamers. This required a multi-faceted approach to build hype and establish a strong brand identity from day one.' } },
      { type: 'imageGrid', data: { images: [{ url: 'https://picsum.photos/seed/mlb-process1/600/400', alt: 'MLB Process Image 1' }, { url: 'https://picsum.photos/seed/mlb-process2/600/400', alt: 'MLB Process Image 2' }] } },
      { type: 'text', data: { heading: 'Strategy', body: 'Directed a multi-disciplinary creative effort, structuring and managing in-house teams, external agencies, and freelance talent. We developed a cohesive, cross-channel campaign spanning broadcast TV, dynamic retail displays, packaging, and high-impact tradeshow experiences to create an unmissable launch event.<br/><br/>The campaign\'s success was built on a deep understanding of the target audience. We combined authentic baseball simulation with high-energy, accessible marketing that spoke to both hardcore fans and newcomers. The retail presence was particularly crucial, with custom displays and interactive kiosks that allowed players to experience the game firsthand. This hands-on approach, coupled with a massive broadcast push, cemented MLB The Show as the premier baseball gaming experience.' } },
      { type: 'text', data: { heading: 'The Impact', body: 'Achieved record-breaking launch sales, surpassing initial projections by 40%. Secured #1 market share in the genre within the first year and established a franchise that has shown incredible longevity, winning multiple "Game of the Year" awards.' } },
      { type: 'image', data: { image: { url: 'https://picsum.photos/seed/mlb-gallery1/1200/800', alt: 'MLB Gallery Image 1' }, size: 'full', caption: '' } },
    ]
  },
  { id: 'atari-revival', title: 'Interplay/Atari Launches', subtitle: 'Case Study: Revitalizing Legacy Brands for a Modern Audience', client: 'Atari / Interplay', tags: ['Brand Identity', 'Packaging', 'Digital Campaign', 'Social Media'], heroImage: { url: 'https://picsum.photos/seed/atari/1200/800', alt: 'Atari promotional image' },
    contentBlocks: [
      { type: 'hero', data: { images: [{ url: 'https://picsum.photos/seed/atari/1200/800', alt: 'Atari promotional image' }], style: 'single' } },
      { type: 'title', data: {} },
      { type: 'text', data: { heading: 'The Challenge', body: "Re-introduce iconic gaming brands to a new generation of players while honoring the nostalgic connection of the original fanbase. The goal was to bridge the gap between retro appeal and modern gaming expectations." } },
      { type: 'text', data: { heading: 'Strategy & Execution', body: 'As the agency-of-record creative lead, I developed a "Modern Nostalgia" creative platform. This involved a complete visual identity refresh, innovative packaging that paid homage to the originals, and digital campaigns that leveraged retro aesthetics within contemporary channels.' } },
      { type: 'text', data: { heading: 'Impact', body: 'Successfully managed creative for 5+ major title launches, resulting in a 300% increase in brand engagement on social media and strong sales in a competitive market. The campaigns were praised for their authentic yet fresh approach to beloved IP.' } },
      { type: 'imageGrid', data: { images: [{ url: 'https://picsum.photos/seed/atari-footer1/400/1200', alt: 'Atari Footer Image 1' }, { url: 'https://picsum.photos/seed/atari-footer2/400/1200', alt: 'Atari Footer Image 2' }, { url: 'https://picsum.photos/seed/atari-footer3/400/1200', alt: 'Atari Footer Image 3' }] } },
      { type: 'text', data: { body: "The key to this project was striking the perfect balance between honoring the past and appealing to the present. We dove deep into the archives to extract core visual elements—pixel art, typography, color palettes—and reinterpreted them for a high-definition world. The result was a brand identity that felt instantly familiar yet undeniably fresh, capturing the imagination of both old-school gamers and a new generation." } },
      { type: 'carousel', data: { images: [{ url: 'https://picsum.photos/seed/atari-gallery1/1200/800', alt: 'Atari Gallery Image 1' }, { url: 'https://picsum.photos/seed/atari-gallery2/1200/800', alt: 'Atari Gallery Image 2' }, { url: 'https://picsum.photos/seed/atari-gallery3/1200/800', alt: 'Atari Gallery Image 3' }] } },
    ]
  },
  { id: 'aura-health', title: 'Aura Health - Medical Device Launch', subtitle: 'Developed a trustworthy and accessible brand identity and patient portal UI/UX, simplifying complex medical information.', client: 'Aura Health Inc.', tags: ['Branding', 'UI/UX Design', 'Patient Portal', 'Healthcare'], heroImage: { url: 'https://picsum.photos/seed/aura/800/600', alt: 'Aura Health user interface on a tablet' },
    contentBlocks: [
      { type: 'hero', data: { images: [{ url: 'https://picsum.photos/seed/aura/800/600', alt: 'Aura Health user interface on a tablet' }, { url: 'https://picsum.photos/seed/aura-gallery1/1200/800', alt: 'Aura Health dashboard view' }], style: 'duo' } },
      { type: 'title', data: {} },
      { type: 'text', data: { heading: 'The Challenge', body: 'Launching a new medical device requires building immediate trust with both patients and healthcare providers. The challenge was to create a brand that felt clinical and reliable, yet warm and approachable. We needed to design a patient portal that could present complex health data in a simple, intuitive, and actionable way, ensuring high user adoption and adherence.' } },
      { type: 'textWithImages', data: { heading: 'Strategy & Execution', body: 'Our strategy was rooted in human-centered design. We conducted extensive user research with patients and doctors to understand their needs and pain points. This led to a brand identity centered around calm colors, clear typography, and an optimistic tone. For the UI/UX, we developed a modular dashboard that prioritized key information, used data visualizations to make trends understandable, and created a secure messaging system to connect patients with their care teams seamlessly.<br/><br/>Accessibility was a core principle throughout the project. We adhered to WCAG 2.1 AA standards, ensuring the portal was usable for people with various disabilities. We also implemented a comprehensive onboarding process within the app, using guided tours and contextual help to reduce the learning curve and empower patients to take control of their health data from day one.', images: [{ url: 'https://picsum.photos/seed/aura-process1/600/400', alt: 'Aura Health design process sketch' }, { url: 'https://picsum.photos/seed/aura-process2/600/400', alt: 'Aura Health user flow diagram' }], imagePosition: 'right' } },
      { type: 'image', data: { image: { url: 'https://picsum.photos/seed/aura-footer1/800/600', alt: 'Aura Health branding materials' }, size: 'medium', caption: 'Branding materials created for the launch.' } },
      { type: 'text', data: { heading: 'Impact', body: 'The launch was highly successful, exceeding initial patient sign-up targets by 60% in the first quarter. Post-launch surveys showed a 95% user satisfaction rate with the portal\'s ease of use. The clear branding and intuitive design were frequently cited by healthcare providers as key factors in their decision to adopt the Aura Health system.' } },
    ]
  },
  { id: 'elysian-beauty', title: 'Elysian Beauty - Cosmetics Line', subtitle: 'Created elegant packaging and a cohesive digital campaign that navigated complex cosmetic regulations while appealing to a luxury market.', client: 'Elysian Beauty Co.', tags: ['Packaging Design', 'Art Direction', 'Digital Campaign', 'Luxury Branding'], heroImage: { url: 'https://picsum.photos/seed/elysian/800/600', alt: 'Elysian Beauty product lineup' }, contentBlocks: [] },
  { id: 'nomad-escapes', title: 'Nomad Escapes - Travel Booking', subtitle: 'Designed a mobile-first booking platform focused on intuitive user flow and immersive destination visuals to drive conversions.', client: 'Nomad Escapes Ltd.', tags: ['Mobile App Design', 'UI/UX', 'Conversion Optimization', 'Travel Tech'], heroImage: { url: 'https://picsum.photos/seed/nomad/800/600', alt: 'Nomad Escapes app showing a destination' }, contentBlocks: [] },
  { id: 'streamline-corp', title: 'Streamline - B2B SaaS', subtitle: 'Led the creative for a B2B platform launch, focusing on clear value propositions and a professional, data-driven aesthetic.', client: 'Streamline Corp.', tags: ['B2B Branding', 'SaaS', 'Product Launch', 'Data Visualization'], heroImage: { url: 'https://picsum.photos/seed/streamline/800/600', alt: 'Streamline SaaS dashboard' }, contentBlocks: [] },
];
const ABOUT_ME = {
  name: 'David Gaines', title: 'Creative Director & Brand Strategist', logoText: 'GD!', headerIcon: { url: '', alt: 'Site Icon' }, heroImage: { url: 'https://images.unsplash.com/photo-1560250097-0b93528c311a?q=80&w=800&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', alt: 'A portrait of David Gaines, Creative Director' }, introStatement: "A highly accomplished Creative Leader with 20+ years of experience solving complex marketing challenges by leading and mentoring creative teams. Committed to elevating craft standards and translating brand strategy into high-impact digital-first concepts.", heroIntro: "A creative leader translating complex brand strategy into high-impact, pixel-perfect design across digital, print, and retail experiences.", philosophy: [{ title: 'Strategy-Driven Creative', text: 'I believe great creative is driven by strategic insight, not just aesthetics. My process begins with understanding the business challenge to ensure every design choice has a purpose and delivers measurable results.' }, { title: 'Mentorship & Team Building', text: "My role as a leader is to mentor the next generation of creatives. I focus on building collaborative, empowered teams where talent can thrive and produce their best work." }, { title: 'Bridging Complexity and User Experience', text: "I specialize in bridging complicated technical requirements with compelling user experiences, translating product features into emotional connections that resonate with audiences." },], obsessions: ['Swiss Typography', 'Japanese Denim', 'Vintage Synthesizers', 'Perfect Espresso', 'Mid-Century Furniture', 'Film Photography'], travelLog: [{ text: 'Tokyo, Japan', completed: true }, { text: 'Reykjavik, Iceland', completed: false }, { text: 'Berlin, Germany', completed: true }, { text: 'Kyoto, Japan', completed: false }, { text: 'Mexico City', completed: false }, { text: 'Copenhagen, Denmark', completed: false }, { text: 'Buenos Aires', completed: false }, { text: 'Seoul, South Korea', completed: false }, { text: 'Lisbon, Portugal', completed: false }], quotes: [{ text: "Good design is as little design as possible.", author: "Dieter Rams" }, { text: "The details are not the details. They make the design.", author: "Charles Eames" }], favorites: { movies: ['Blade Runner 2049', 'Arrival', 'Grand Budapest Hotel'], shows: ['Severance', 'The Bear', 'Succession'], podcasts: ['99% Invisible', 'Design Matters', 'How I Built This'], audiobooks: ['The Creative Act', 'Steve Jobs', 'Kitchen Confidential'] }, panorama: { url: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=2000&auto=format&fit=crop', alt: 'A beautiful panoramic landscape for visual inspiration' }, inspirationGrid: [{ url: 'https://images.unsplash.com/photo-1513364776144-60967b0f800f?q=80&w=1200&auto=format&fit=crop', alt: 'Inspiration image 1' }, { url: 'https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?q=80&w=1200&auto=format&fit=crop', alt: 'Inspiration image 2' }, { url: 'https://images.unsplash.com/photo-1497215728101-856f4ea42174?q=80&w=1200&auto=format&fit=crop', alt: 'Inspiration image 3' }, { url: 'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?q=80&w=1200&auto=format&fit=crop', alt: 'Inspiration image 4' }, { url: 'https://images.unsplash.com/photo-1605106702842-01a887a31122?q=80&w=1200&auto=format&fit=crop', alt: 'Inspiration image 5' }, { url: 'https://images.unsplash.com/photo-1502945015378-0e284ca1a5be?q=80&w=1200&auto=format&fit=crop', alt: 'Inspiration image 6' }], resumeUrl: '#', socialLinks: [{ iconUrl: 'linkedin', linkUrl: 'https://linkedin.com/in/davidrgaines' }], email: 'dave@gainesdg.com', phone: '949.463.1867', brandPrimary: '#0891b2', brandSecondary: '#f0f9ff', headerBgColor: '#0f172a', heroBgColor: '#0f172a', seoTitle: 'David Gaines | Creative Director Portfolio', seoDescription: 'A personal portfolio website for Creative Director David Gaines, showcasing impact, strategy, leadership, and adaptability through curated case studies and recent work.',
  pageHeadings: {
    aboutTitle: 'About Me <span class="text-brand-primary">&</span> <br/>The Process',
    philosophySubtitle: 'Strategy first. <br/> Design second.',
    obsessionsTitle: 'Obsessed With',
    bucketListTitle: 'Bucket List',
    mediaDietTitle: 'Media Diet',
    mediaDietMovies: 'Movies',
    mediaDietShows: 'Shows',
    mediaDietPodcasts: 'Podcasts',
    mediaDietAudiobooks: 'Audiobooks',
  },
};

// --- Inlined from lib/firebase.ts ---
const firebaseConfig = { apiKey: "AIzaSyDAaX8so7wzwuhuWHeNN8CXWfHnXx9dREQ", authDomain: "port-82839.firebaseapp.com", projectId: "port-82839", storageBucket: "port-82839.firebasestorage.app", messagingSenderId: "463866065220", appId: "1:463866065220:web:775b841f67d43b64e8a711" };
const isConfigured = firebaseConfig.apiKey && !firebaseConfig.apiKey.startsWith("PASTE_");
let app = null, auth = null, db = null;
if (isConfigured) {
  try {
    app = initializeApp(firebaseConfig);
    auth = getAuth(app);
    db = getFirestore(app);
  } catch (error) {
    console.error("Firebase initialization failed.", error);
  }
}

// --- Inlined from components/ui/CustomCursor.tsx ---
const CursorHoverStateContext = createContext(undefined);
const CursorHoverDispatchContext = createContext(undefined);

const CursorHoverProvider = ({ children }) => {
  const [hoverState, setHoverState] = useState({ isHovering: false, text: undefined });
  return (
    <CursorHoverStateContext.Provider value={hoverState}>
        <CursorHoverDispatchContext.Provider value={setHoverState}>
            {children}
        </CursorHoverDispatchContext.Provider>
    </CursorHoverStateContext.Provider>
  );
};

const CustomCursor = () => {
    const hoverState = useContext(CursorHoverStateContext);
    const { isHovering, text } = hoverState || {};
    const [position, setPosition] = useState({ x: -100, y: -100 });

    useEffect(() => {
        const handleMouseMove = (e) => {
            setPosition({ x: e.clientX, y: e.clientY });
        };
        const handleMouseLeave = () => {
          setPosition({ x: -100, y: -100 });
        }
        window.addEventListener('mousemove', handleMouseMove);
        document.documentElement.addEventListener('mouseleave', handleMouseLeave);

        return () => {
            window.removeEventListener('mousemove', handleMouseMove);
            document.documentElement.removeEventListener('mouseleave', handleMouseLeave);
        };
    }, []);

    const hasText = !!text;
    const scale = hasText ? 1.2 : (isHovering ? 0.5 : 0);

    return (
        <div className="custom-cursor-container pointer-events-none fixed inset-0 z-[9999] hidden md:block">
            <div 
                className="absolute w-8 h-8 rounded-full bg-white flex items-center justify-center transition-transform duration-200 ease-out"
                style={{ 
                    top: `${position.y}px`, 
                    left: `${position.x}px`, 
                    transform: `translate(-50%, -50%) scale(${scale})`,
                    willChange: 'transform' 
                }}
            >
              {hasText && <span className="text-[7px] font-bold text-base-dark tracking-widest uppercase">{text}</span>}
            </div>
            <div 
                className={`absolute w-2 h-2 rounded-full bg-brand-primary transition-transform duration-200 ease-out`} 
                style={{ 
                    left: `${position.x}px`, 
                    top: `${position.y}px`, 
                    transform: `translate(-50%, -50%) scale(${isHovering || hasText ? 0 : 1})`, 
                    willChange: 'transform' 
                }} 
            />
        </div>
    );
};

// --- Inlined from hooks/useRouter.ts ---
const useRouter = () => {
  const setHoverState = useContext(CursorHoverDispatchContext);
  const [path, setPath] = useState(window.location.hash || '#/');

  useEffect(() => {
    const onHashChange = () => {
      setPath(window.location.hash || '#/');
      window.scrollTo(0, 0);
      // Reset cursor state on navigation to prevent leaks
      if (setHoverState) {
        setHoverState({ isHovering: false, text: undefined });
      }
    };
    window.addEventListener('hashchange', onHashChange);
    window.scrollTo(0, 0);
    return () => window.removeEventListener('hashchange', onHashChange);
  }, [setHoverState]);

  return { path };
};


// --- Inlined from context/ContentContext.tsx ---
const ContentContext = createContext(undefined);
const useContent = () => {
  const context = useContext(ContentContext);
  if (!context) throw new Error('useContent must be used within a ContentProvider');
  return context;
};
const ContentProvider = ({ children }) => {
  const [heroProjects, setHeroProjects] = useState(HERO_PROJECTS);
  const [aboutMe, setAboutMe] = useState(ABOUT_ME);
  const [clientLogos, setClientLogos] = useState(CLIENT_LOGOS);
  const [brandLogos, setBrandLogos] = useState(BRAND_LOGOS);
  const [isFirebaseActive, setIsFirebaseActive] = useState(false);
  const [isAuthenticated, setIsAuthenticated] = useState(false);
  
  const toImageObject = (data, defaultAlt = '') => {
    if (typeof data === 'string') return { url: data, alt: defaultAlt };
    if (typeof data === 'object' && data !== null && data.url) return { url: data.url, alt: data.alt || defaultAlt };
    return { url: '', alt: '' };
  };
  
  const toImageArray = (data) => {
      if (!Array.isArray(data)) return [];
      return data.map((item, index) => toImageObject(item, `Image ${index + 1}`));
  };

  const toSocialLinkArray = (data) => {
    if (!Array.isArray(data)) return [];
    return data.map(item => ({
        iconUrl: item.iconUrl || '',
        linkUrl: item.linkUrl || '',
    }));
  };

  const mergeAboutMeData = (partialData) => {
    let travelLog = partialData.travelLog;
    if (Array.isArray(travelLog) && travelLog.length > 0 && typeof travelLog[0] === 'string') {
        travelLog = travelLog.map(text => ({ text, completed: false }));
    }
    
    // Legacy image data migration
    if (partialData.headerIconUrl) {
      partialData.headerIcon = toImageObject(partialData.headerIconUrl, 'Site Icon');
      delete partialData.headerIconUrl;
    }
    if (partialData.heroImage) partialData.heroImage = toImageObject(partialData.heroImage, 'Portrait of David Gaines');
    if (partialData.panoramaImage) {
        partialData.panorama = toImageObject(partialData.panoramaImage, 'Inspiring panoramic landscape');
        delete partialData.panoramaImage;
    }
    if (partialData.inspirationGrid) partialData.inspirationGrid = toImageArray(partialData.inspirationGrid);
    
    // Legacy linkedInUrl migration
    if (partialData.linkedInUrl && (!partialData.socialLinks || partialData.socialLinks.length === 0)) {
        partialData.socialLinks = [{ iconUrl: 'linkedin', linkUrl: partialData.linkedInUrl }];
        delete partialData.linkedInUrl;
    }


    return {
      ...ABOUT_ME,
      ...partialData,
      headerIcon: toImageObject(partialData.headerIcon || ABOUT_ME.headerIcon, 'Site Icon'),
      heroImage: toImageObject(partialData.heroImage || ABOUT_ME.heroImage, 'Portrait of David Gaines'),
      panorama: toImageObject(partialData.panorama || ABOUT_ME.panorama, 'Inspiring panoramic landscape'),
      inspirationGrid: toImageArray(partialData.inspirationGrid || ABOUT_ME.inspirationGrid),
      philosophy: Array.isArray(partialData.philosophy) ? partialData.philosophy : ABOUT_ME.philosophy,
      obsessions: Array.isArray(partialData.obsessions) ? partialData.obsessions : ABOUT_ME.obsessions,
      travelLog: Array.isArray(travelLog) && travelLog.every(i => typeof i === 'object') ? travelLog : ABOUT_ME.travelLog,
      quotes: Array.isArray(partialData.quotes) ? partialData.quotes : ABOUT_ME.quotes,
      favorites: (typeof partialData.favorites === 'object' && partialData.favorites !== null) ? { ...ABOUT_ME.favorites, ...partialData.favorites } : ABOUT_ME.favorites,
      pageHeadings: (typeof partialData.pageHeadings === 'object' && partialData.pageHeadings !== null) ? { ...ABOUT_ME.pageHeadings, ...partialData.pageHeadings } : ABOUT_ME.pageHeadings,
      socialLinks: toSocialLinkArray(partialData.socialLinks || ABOUT_ME.socialLinks),
    };
  };
  
  const mergeHeroProjectsData = (projectsData) => {
    if (!Array.isArray(projectsData)) return HERO_PROJECTS;
    return projectsData.map(p => {
        const defaultProject = HERO_PROJECTS.find(dp => dp.id === p.id) || {};
        
        // Ensure contentBlocks and their inner images are properly formatted
        const contentBlocks = Array.isArray(p.contentBlocks) ? p.contentBlocks.map(block => {
            if (!block.data) return block;
            const newBlockData = { ...block.data };
            if (newBlockData.image) newBlockData.image = toImageObject(newBlockData.image);
            if (newBlockData.images) newBlockData.images = toImageArray(newBlockData.images);
            return { ...block, data: newBlockData };
        }) : defaultProject.contentBlocks;
        
        return {
            ...defaultProject,
            ...p,
            heroImage: toImageObject(p.heroImage, `${p.title} hero image`),
            homePageImage: p.homePageImage ? toImageObject(p.homePageImage, `${p.homePageTitle || p.title} homepage image`) : null,
            contentBlocks,
        }
    })
  }


  useEffect(() => {
    try {
      const storedProjects = localStorage.getItem('heroProjects');
      if (storedProjects) { const parsed = JSON.parse(storedProjects); if (Array.isArray(parsed)) setHeroProjects(mergeHeroProjectsData(parsed)); }
      const storedAboutMe = localStorage.getItem('aboutMe');
      if (storedAboutMe) { const parsed = JSON.parse(storedAboutMe); if (typeof parsed === 'object' && parsed !== null) setAboutMe(mergeAboutMeData(parsed)); }
      const storedClientLogos = localStorage.getItem('clientLogos');
      if (storedClientLogos) { const parsed = JSON.parse(storedClientLogos); if (Array.isArray(parsed)) setClientLogos(parsed); }
      const storedBrandLogos = localStorage.getItem('brandLogos');
      if (storedBrandLogos) { const parsed = JSON.parse(storedBrandLogos); if (Array.isArray(parsed)) setBrandLogos(parsed); }
    } catch (error) {
      console.error("Failed to parse localStorage data.", error);
      localStorage.clear();
    }

    if (auth) onAuthStateChanged(auth, (user) => setIsAuthenticated(!!user));

    if (db) {
      setIsFirebaseActive(true);
      const unsubProjects = onSnapshot(doc(db, 'content', 'heroProjects'), (doc) => {
        const data = doc.data()?.data;
        if (doc.exists() && Array.isArray(data)) setHeroProjects(mergeHeroProjectsData(data));
      });
      const unsubAbout = onSnapshot(doc(db, 'content', 'aboutMe'), (doc) => {
        const data = doc.data()?.data;
        if (doc.exists() && typeof data === 'object' && data !== null) setAboutMe(mergeAboutMeData(data));
      });
      const unsubLogos = onSnapshot(doc(db, 'content', 'logos'), (doc) => {
        if (doc.exists()) {
          const data = doc.data();
          if (Array.isArray(data.clientLogos)) setClientLogos(data.clientLogos);
          if (Array.isArray(data.brandLogos)) setBrandLogos(data.brandLogos);
        }
      });
      return () => { unsubProjects(); unsubAbout(); unsubLogos(); };
    }
  }, []);
  
  useEffect(() => {
    document.documentElement.style.setProperty('--brand-primary', aboutMe.brandPrimary || '#0891b2');
    document.documentElement.style.setProperty('--brand-secondary', aboutMe.brandSecondary || '#f0f9ff');
    document.documentElement.style.setProperty('--hero-bg-color', aboutMe.heroBgColor || '#0f172a');

    const setMetaTag = (attr, key, value) => {
        let element = document.querySelector(`meta[${attr}='${key}']`);
        if (!element) {
            element = document.createElement('meta');
            element.setAttribute(attr, key);
            document.head.appendChild(element);
        }
        element.setAttribute('content', value || '');
    };

    document.title = aboutMe.seoTitle || 'David Gaines | Creative Director Portfolio';
    setMetaTag('name', 'description', aboutMe.seoDescription);
    
    // --- OG & Twitter Tags ---
    const pageUrl = window.location.origin;
    const ogImage = aboutMe.heroImage?.url || '';
    
    setMetaTag('property', 'og:title', aboutMe.seoTitle);
    setMetaTag('property', 'og:description', aboutMe.seoDescription);
    setMetaTag('property', 'og:type', 'website');
    setMetaTag('property', 'og:url', pageUrl);
    setMetaTag('property', 'og:image', ogImage);
    
    setMetaTag('name', 'twitter:card', 'summary_large_image');
    setMetaTag('name', 'twitter:title', aboutMe.seoTitle);
    setMetaTag('name', 'twitter:description', aboutMe.seoDescription);
    setMetaTag('name', 'twitter:image', ogImage);

    const hexToRgb = (hex) => {
        let result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? { r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16) } : null;
    };
    const headerRgb = hexToRgb(aboutMe.headerBgColor || '#0f172a');
    if (headerRgb) {
        document.documentElement.style.setProperty('--header-bg-color-rgb', `${headerRgb.r}, ${headerRgb.g}, ${headerRgb.b}`);
    }

  }, [aboutMe]);

  const persist = async (key, data, firestoreCollection = 'content') => {
    localStorage.setItem(key, JSON.stringify(data));
    if (db && isAuthenticated) {
      try {
        await setDoc(doc(db, firestoreCollection, key), { data });
      } catch (e) {
        console.error("Error saving to Firebase", e);
      }
    }
  };

  const updateAboutMe = (data) => { setAboutMe(data); persist('aboutMe', data); };
  const updateHeroProjects = (projects) => { setHeroProjects(projects); persist('heroProjects', projects); };
  
  const updateLogos = (newClientLogos, newBrandLogos) => {
    setClientLogos(newClientLogos);
    setBrandLogos(newBrandLogos);
    
    localStorage.setItem('clientLogos', JSON.stringify(newClientLogos));
    localStorage.setItem('brandLogos', JSON.stringify(newBrandLogos));

    if (db && isAuthenticated) {
        const docRef = doc(db, 'content', 'logos');
        setDoc(docRef, { clientLogos: newClientLogos, brandLogos: newBrandLogos })
            .catch(e => console.error("Error saving logos to Firebase", e));
    }
  };

  const resetToDefaults = () => {
    setHeroProjects(HERO_PROJECTS); setAboutMe(ABOUT_ME); setClientLogos(CLIENT_LOGOS); setBrandLogos(BRAND_LOGOS);
    localStorage.removeItem('heroProjects'); localStorage.removeItem('aboutMe'); localStorage.removeItem('clientLogos'); localStorage.removeItem('brandLogos');
    alert("Local data reset.");
  };

  return (
    <ContentContext.Provider value={{ heroProjects, aboutMe, clientLogos, brandLogos, updateAboutMe, updateHeroProjects, updateLogos, resetToDefaults, isFirebaseActive }}>
      {children}
    </ContentContext.Provider>
  );
};

// --- Inlined Components ---
const ArrowUpRightIcon = ({ className = "h-6 w-6" }) => (<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M4.5 19.5 19.5 4.5M19.5 4.5v15M19.5 4.5h-15" /></svg>);
const LinkedInIcon = ({ className = "h-6 w-6" }) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={className}><path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.25 6.5 1.75 1.75 0 016.5 8.25zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93-.98 0-1.62.67-1.62 1.93V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.38 1.02 3.38 3.54z"></path></svg>);

const Header = () => {
  const setHoverState = useContext(CursorHoverDispatchContext);
  const { path } = useRouter();
  const { aboutMe } = useContent();
  const [isContactOpen, setIsContactOpen] = useState(false);
  const [isMobileContactOpen, setIsMobileContactOpen] = useState(false);
  const contactTimeoutRef = useRef(null);

  const mobileDropdownRef = useRef(null);
  const mobileContactButtonRef = useRef(null);

  // Effect to handle clicking outside the mobile contact dropdown
  useEffect(() => {
    const handleClickOutside = (event) => {
      if (
        isMobileContactOpen &&
        mobileDropdownRef.current && !mobileDropdownRef.current.contains(event.target) &&
        (!mobileContactButtonRef.current || !mobileContactButtonRef.current.contains(event.target))
      ) {
        setIsMobileContactOpen(false);
      }
    };
    document.addEventListener("mousedown", handleClickOutside);
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, [isMobileContactOpen]);

  const handleContactEnter = () => {
    if (contactTimeoutRef.current) {
      clearTimeout(contactTimeoutRef.current);
    }
    setIsContactOpen(true);
  };

  const handleContactLeave = () => {
    contactTimeoutRef.current = setTimeout(() => {
      setIsContactOpen(false);
    }, 150);
  };

  const handleHomeClick = (e) => { e.preventDefault(); window.location.hash = '#/'; };
  const handleAboutClick = (e) => { e.preventDefault(); window.location.hash = '#/about'; };

  return (
    <header className="sticky top-0 z-50 header-with-blur">
      <div className="container mx-auto px-4 sm:px-6 lg:px-8 relative">
        <nav>
            <div className="flex items-center justify-between h-16">
              <div className="flex-shrink-0">
                <a 
                  href="#/" 
                  onClick={handleHomeClick} 
                  className="flex items-center text-sm font-medium uppercase tracking-wider transition-all duration-300 hover:scale-105 text-text-secondary hover:text-text-primary"
                  onMouseEnter={() => setHoverState({ isHovering: true })} 
                  onMouseLeave={() => setHoverState({ isHovering: false })}
                >
                  {aboutMe.headerIcon?.url && <img src={aboutMe.headerIcon.url} alt={aboutMe.headerIcon.alt} className="h-6 mr-3" />}
                  <span className={`${path === '#/' || path === '' ? 'text-brand-primary' : ''}`}>{aboutMe.logoText}</span>
                </a>
              </div>
              <div className="hidden md:block">
                <div className="ml-10 flex items-baseline space-x-4">
                  <a href="#/" onClick={handleHomeClick} className={`relative px-3 py-2 text-sm font-medium transition-colors uppercase tracking-wider ${path === '#/' || path === '' ? 'text-brand-primary' : 'text-text-secondary hover:text-text-primary'}`} onMouseEnter={() => setHoverState({ isHovering: true })} onMouseLeave={() => setHoverState({ isHovering: false })}>Home{(path === '#/' || path === '') && (<span className="absolute bottom-0 left-1/2 -translate-x-1/2 w-2/3 h-0.5 bg-brand-primary rounded-full"></span>)}</a>
                  <a href="#/about" onClick={handleAboutClick} className={`relative px-3 py-2 text-sm font-medium transition-colors uppercase tracking-wider ${path === '#/about' ? 'text-brand-primary' : 'text-text-secondary hover:text-text-primary'}`} onMouseEnter={() => setHoverState({ isHovering: true })} onMouseLeave={() => setHoverState({ isHovering: false })}>About{path === '#/about' && (<span className="absolute bottom-0 left-1/2 -translate-x-1/2 w-2/3 h-0.5 bg-brand-primary rounded-full"></span>)}</a>
                  
                  <div 
                    className="relative"
                    onMouseEnter={handleContactEnter}
                    onMouseLeave={handleContactLeave}
                  >
                    <div 
                      className={`relative px-3 py-2 text-sm font-medium transition-colors uppercase tracking-wider cursor-pointer ${isContactOpen ? 'text-brand-primary' : 'text-text-secondary hover:text-text-primary'}`}
                      onMouseEnter={() => setHoverState({ isHovering: true })}
                      onMouseLeave={() => setHoverState({ isHovering: false })}
                    >
                      Contact
                      {isContactOpen && (<span className="absolute bottom-0 left-1/2 -translate-x-1/2 w-2/3 h-0.5 bg-brand-primary rounded-full"></span>)}
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </nav>
        <div
          onMouseEnter={handleContactEnter}
          onMouseLeave={handleContactLeave}
          style={{ backgroundColor: aboutMe.brandPrimary }}
          className={`absolute top-0 right-4 w-56 transition-transform duration-300 ease-out z-40 shadow-lg rounded-b-lg
            ${isContactOpen ? 'translate-y-0' : '-translate-y-full'}`
          }
        >
          <div className="pt-20 pb-6 px-6 text-right space-y-2">
            <a href={`mailto:${aboutMe.email}`} className="block text-sm text-brand-secondary hover:text-white transition-colors" role="menuitem" onMouseEnter={() => setHoverState({ isHovering: true })} onMouseLeave={() => setHoverState({ isHovering: false })}>
              {aboutMe.email}
            </a>
            <a href={`tel:${aboutMe.phone.replace(/[^0-9+]/g, '')}`} className="block text-sm text-brand-secondary hover:text-white transition-colors" role="menuitem" onMouseEnter={() => setHoverState({ isHovering: true })} onMouseLeave={() => setHoverState({ isHovering: false })}>
              {aboutMe.phone}
            </a>
          </div>
        </div>
      </div>
      
      {isMobileContactOpen && (
        <div ref={mobileDropdownRef} className="md:hidden absolute w-full bg-base-dark/95 backdrop-blur-md shadow-lg border-b border-base-light animate-fade-in-up" style={{ animationDuration: '300ms' }}>
          <div className="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div className="flex flex-col items-center justify-center gap-4">
              <a href={`mailto:${aboutMe.email}`} className="text-white hover:text-brand-secondary transition-colors text-sm font-medium uppercase tracking-wider">{aboutMe.email}</a>
              <a href={`tel:${aboutMe.phone.replace(/[^0-9+]/g, '')}`} className="text-text-secondary hover:text-white transition-colors text-sm font-medium uppercase tracking-wider">{aboutMe.phone}</a>
            </div>
          </div>
        </div>
      )}

      <div className="md:hidden bg-base-dark/95 backdrop-blur-md border-t border-base-light">
        <div className="px-2 pt-2 pb-3 space-y-1 sm:px-3 flex justify-center items-center">
          <div className="flex gap-4">
            <a href="#/" onClick={handleHomeClick} className={`relative px-3 py-2 text-sm font-medium uppercase tracking-wider ${path === '#/' || path === '' ? 'text-brand-primary' : 'text-text-secondary'}`}>Home</a>
            <a href="#/about" onClick={handleAboutClick} className={`relative px-3 py-2 text-sm font-medium uppercase tracking-wider ${path === '#/about' ? 'text-brand-primary' : 'text-text-secondary'}`}>About</a>
            <button ref={mobileContactButtonRef} onClick={() => setIsMobileContactOpen(prev => !prev)} className={`relative px-3 py-2 text-sm font-medium uppercase tracking-wider ${isMobileContactOpen ? 'text-brand-primary' : 'text-text-secondary'}`} aria-expanded={isMobileContactOpen}>Contact</button>
          </div>
        </div>
      </div>
    </header>
  );
};


const SectionHeader = ({ title, subtitle, titleClassName = 'text-text-primary' }) => (
  <div className="text-center mb-12 md:mb-16">
    {subtitle && <h2 className="text-sm font-bold text-brand-primary uppercase tracking-widest mb-2">{subtitle}</h2>}
    <p className={`text-3xl md:text-4xl font-bold tracking-tight ${titleClassName}`}>{title}</p>
  </div>
);

const HeroSection = () => {
  const { aboutMe } = useContent();
  return (
    <section className="relative py-12 md:py-16 text-center" style={{ backgroundColor: aboutMe.heroBgColor }}>
      <div className="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <h1 className="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-black text-text-primary tracking-tighter uppercase">{aboutMe.name}</h1>
        <p className="mt-4 text-lg sm:text-xl md:text-2xl text-brand-primary font-semibold">{aboutMe.title}</p>
        <p className="mt-6 max-w-2xl mx-auto text-base sm:text-lg text-text-secondary leading-relaxed">{aboutMe.heroIntro}</p>
      </div>
    </section>
  );
};

const PartnersSection = () => {
  const { clientLogos, brandLogos } = useContent();
  const Marquee = ({ logos, direction }) => {
    if (!logos || logos.length === 0) return null;
    const allLogos = [...logos, ...logos]; 
    const animationClass = direction === 'left' ? 'animate-infinite-scroll-left' : 'animate-infinite-scroll-right';
    return (
      <div className="w-full inline-flex flex-nowrap overflow-hidden [mask-image:_linear_gradient(to_right,transparent_0,_black_128px,_black_calc(100%-128px),transparent_100%)]">
        <ul className={`flex items-center justify-center md:justify-start [&_img]:max-w-none ${animationClass}`}>
          {allLogos.map((logo, index) => (
            <li key={index} className={`flex-shrink-0 w-48 h-16 flex justify-center items-center px-4`} aria-hidden={true}>
              <img src={logo} alt="" className="max-w-full max-h-full object-contain hover:scale-110 transition-transform duration-300" />
            </li>
          ))}
        </ul>
      </div>
    );
  };
  return (
    <section className="pt-6 pb-12 bg-white">
      <div className="flex flex-col items-center w-full">
        <h3 className="text-center text-xs font-bold text-slate-500 tracking-[0.25em] uppercase mb-6">CLIENTS</h3>
        <div className="w-full flex flex-col gap-3 mb-6">
           <Marquee logos={clientLogos} direction="left" />
           <Marquee logos={brandLogos} direction="right" />
        </div>
        <h3 className="text-center text-xs font-bold text-slate-500 tracking-[0.25em] uppercase">BRANDS</h3>
      </div>
    </section>
  );
};

const WorkOverviewSection = () => {
  const { heroProjects } = useContent();
  const allProjects = heroProjects.map(p => ({ 
      id: p.id, 
      title: p.homePageTitle || p.title, 
      description: p.homePageSubtitle || p.subtitle, 
      image: p.homePageImage || p.heroImage 
  })).filter(p => p.image && p.image.url);
  
  const WorkCard = ({ project, index }) => {
    const setHoverState = useContext(CursorHoverDispatchContext);
    const handleNavigation = (e) => { e.preventDefault(); window.location.hash = `#/project/${project.id}`; };
    
    const cardContent = (
      <>
        <img src={project.image.url} alt={project.image.alt} className="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" />
        <div className="absolute inset-0 bg-gradient-to-t from-black/90 to-transparent" />
        <div className="absolute bottom-0 left-0 p-4 md:p-6">
          <h3 className="text-lg md:text-xl font-bold text-text-primary">{project.title}</h3>
          <p className="text-text-secondary text-xs md:text-sm mt-1 max-w-sm">{project.description}</p>
        </div>
      </>
    );

    return (
      <a 
        href={`#/project/${project.id}`} 
        onClick={handleNavigation} 
        className="group block relative overflow-hidden rounded-lg bg-base-medium shadow-lg aspect-[4/3] sm:aspect-[16/9] opacity-0 animate-fade-in-up" 
        style={{ animationDelay: `${index * 100}ms` }} 
        onMouseEnter={() => setHoverState({ isHovering: true, text: 'VIEW' })} 
        onMouseLeave={() => setHoverState({ isHovering: false, text: undefined })}
      >
        {cardContent}
      </a>
    );
  };

  return (
    <section className="pt-16 pb-6 bg-white">
      <div className="container mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex flex-wrap justify-center -m-4">
          {allProjects.map((project, index) => (
            <div key={project.id} className="w-full md:w-1/2 lg:w-1/3 p-4">
              <WorkCard project={project} index={index} />
            </div>
          ))}
        </div>
      </div>
    </section>
  );
};

const HomePage = () => (
  <>
    <HeroSection />
    <WorkOverviewSection />
    <PartnersSection />
  </>
);

const AboutPage = () => {
  const { aboutMe } = useContent();
  const topRowImages = aboutMe.inspirationGrid ? aboutMe.inspirationGrid.slice(0, 3) : [];
  const bottomRowImages = aboutMe.inspirationGrid ? aboutMe.inspirationGrid.slice(3, 6) : [];
  const allInspirationImages = [...topRowImages, ...(aboutMe.panorama?.url ? [aboutMe.panorama] : []), ...bottomRowImages];

  return (
    <div className="bg-white text-slate-900 animate-fade-in-up pb-12">
      <section className="bg-base-dark py-12 md:py-16 overflow-hidden text-white"><div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
          <h1 className="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-black tracking-tighter uppercase mb-8" dangerouslySetInnerHTML={{ __html: aboutMe.pageHeadings.aboutTitle }}></h1>
          <p className="text-base sm:text-lg text-slate-300 max-w-2xl leading-relaxed" dangerouslySetInnerHTML={{ __html: aboutMe.introStatement }}></p>
      </div></section>
      <div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-5xl">
        <section className="py-12"><div className="flex flex-col md:flex-row gap-12 items-start">
              <div className="md:w-1/3 md:sticky top-24"><h2 className="text-sm font-bold text-brand-primary uppercase tracking-widest mb-4">My Philosophy</h2><p className="text-2xl sm:text-3xl md:text-4xl font-bold text-slate-900 leading-tight tracking-tight" dangerouslySetInnerHTML={{ __html: aboutMe.pageHeadings.philosophySubtitle }}></p></div>
              <div className="md:w-2/3 grid gap-12">{aboutMe.philosophy.map((item, idx) => (<div key={idx}><h3 className="text-xl md:text-2xl font-bold mb-3 text-slate-900">{item.title}</h3><p className="text-base text-slate-600 leading-relaxed" dangerouslySetInnerHTML={{ __html: item.text }}></p></div>))}</div>
        </div></section>
        <hr className="border-slate-200" />
        <section className="py-12">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-16">
                <div><h3 className="text-xl md:text-2xl font-bold text-slate-900 mb-6">{aboutMe.pageHeadings.obsessionsTitle}</h3><ul className="grid grid-cols-1 sm:grid-cols-2 gap-4 list-none">{aboutMe.obsessions.map((item, i) => (<li key={i} className="text-slate-600 text-base">{item}</li>))}</ul></div>
                <div><h3 className="text-xl md:text-2xl font-bold text-slate-900 mb-6">{aboutMe.pageHeadings.bucketListTitle}</h3>
                    <ul className="grid grid-cols-2 gap-x-8 gap-y-3">
                        {(aboutMe.travelLog || []).map((item, i) => (
                            <li key={i} className="flex items-center text-slate-600 text-base">
                                <span className={`w-5 h-5 border-2 ${item.completed ? 'bg-brand-primary border-brand-primary' : 'border-slate-300'} rounded-sm flex items-center justify-center mr-3 flex-shrink-0`}>
                                    {item.completed && <svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="3" d="M5 13l4 4L19 7" /></svg>}
                                </span>
                                <span className={item.completed ? 'line-through text-slate-400' : ''}>{item.text}</span>
                            </li>
                        ))}
                    </ul>
                </div>
            </div>
            <div className="mt-16"><h3 className="text-xl md:text-2xl font-bold text-slate-900 mb-8">{aboutMe.pageHeadings.mediaDietTitle}</h3><div className="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-8">
                <div><h4 className="text-sm font-bold text-brand-primary uppercase tracking-widest mb-4">{aboutMe.pageHeadings.mediaDietMovies}</h4><ul className="space-y-2 text-slate-600 text-base">{aboutMe.favorites.movies.map((item, i) => <li key={i}>{item}</li>)}</ul></div>
                <div><h4 className="text-sm font-bold text-brand-primary uppercase tracking-widest mb-4">{aboutMe.pageHeadings.mediaDietShows}</h4><ul className="space-y-2 text-slate-600 text-base">{aboutMe.favorites.shows.map((item, i) => <li key={i}>{item}</li>)}</ul></div>
                <div><h4 className="text-sm font-bold text-brand-primary uppercase tracking-widest mb-4">{aboutMe.pageHeadings.mediaDietPodcasts}</h4><ul className="space-y-2 text-slate-600 text-base">{aboutMe.favorites.podcasts.map((item, i) => <li key={i}>{item}</li>)}</ul></div>
                <div><h4 className="text-sm font-bold text-brand-primary uppercase tracking-widest mb-4">{aboutMe.pageHeadings.mediaDietAudiobooks}</h4><ul className="space-y-2 text-slate-600 text-base">{aboutMe.favorites.audiobooks.map((item, i) => <li key={i}>{item}</li>)}</ul></div>
            </div></div>
        </section>
      </div>
      <section className="py-12">
        <div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl space-y-6">
          <div className="hidden md:grid grid-cols-1 md:grid-cols-3 gap-6">{topRowImages.map((img, index) => (<div key={`top-${index}`} className="aspect-video relative rounded-lg overflow-hidden shadow-sm bg-slate-100"><img src={img.url} alt={img.alt} className="absolute inset-0 w-full h-full object-cover" /></div>))}</div>
          {aboutMe.panorama?.url && <div className="hidden md:block w-full aspect-video md:aspect-[16/3] overflow-hidden rounded-lg shadow-lg relative"><img src={aboutMe.panorama.url} alt={aboutMe.panorama.alt} className="absolute inset-0 w-full h-full object-cover" /></div>}
          <div className="hidden md:grid grid-cols-1 md:grid-cols-3 gap-6">{bottomRowImages.map((img, index) => (<div key={`bottom-${index}`} className="aspect-video relative rounded-lg overflow-hidden shadow-sm bg-slate-100"><img src={img.url} alt={img.alt} className="absolute inset-0 w-full h-full object-cover" /></div>))}</div>
          <div className="md:hidden">
            <ProjectImageCarousel images={allInspirationImages} />
          </div>
        </div>
      </section>
    </div>
  );
};

// --- Inlined from components/pages/CaseStudyDetailPage.tsx ---
const ChevronIcon = ({ className }) => (<svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" /></svg>);
const ProjectNavigation = ({ currentProjectId, projects }) => {
  const currentIndex = projects.findIndex(p => p.id === currentProjectId);
  if (currentIndex === -1 || projects.length <= 1) return null;
  const prevProject = projects[(currentIndex - 1 + projects.length) % projects.length];
  const nextProject = projects[(currentIndex + 1) % projects.length];
  const handlePrev = (e) => { e.preventDefault(); window.location.hash = `#/project/${prevProject.id}`; };
  const handleNext = (e) => { e.preventDefault(); window.location.hash = `#/project/${nextProject.id}`; };
  const buttonClass = "absolute top-1/2 -translate-y-1/2 flex items-center justify-center w-12 h-24 md:w-16 md:h-32 bg-white/20 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-all duration-300 text-slate-800 hover:bg-white/80 hover:scale-105 z-30";
  return (<><a href={`#/project/${prevProject.id}`} onClick={handlePrev} className={`${buttonClass} left-0 rounded-r-lg`} aria-label={`Previous project: ${prevProject.title}`}><ChevronIcon className="w-6 h-6 transform rotate-180" /></a><a href={`#/project/${nextProject.id}`} onClick={handleNext} className={`${buttonClass} right-0 rounded-l-lg`} aria-label={`Next project: ${nextProject.title}`}><ChevronIcon className="w-6 h-6" /></a></>);
};
const ProjectImageCarousel = ({ images }) => {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [isPaused, setIsPaused] = useState(false);
  const setHoverState = useContext(CursorHoverDispatchContext);
  useEffect(() => {
    if (images.length <= 1 || isPaused) return;
    const timer = setInterval(() => { setCurrentIndex((prevIndex) => (prevIndex + 1) % images.length); }, 4000);
    return () => clearInterval(timer);
  }, [images.length, isPaused]);
  if (!images || images.length === 0) return null;
  return (
    <div className="relative w-full aspect-[16/9] overflow-hidden rounded-lg shadow-xl group" onMouseEnter={() => setIsPaused(true)} onMouseLeave={() => setIsPaused(false)}>
      {images.map((image, index) => (<img key={index} src={image.url} alt={image.alt} className={`absolute top-0 left-0 w-full h-full object-cover transition-opacity duration-1000 ease-in-out ${index === currentIndex ? 'opacity-100' : 'opacity-0'}`} />))}
      {images.length > 1 && (<div className="absolute bottom-6 right-6 z-20 flex gap-3">{images.map((_, index) => (<button key={index} onClick={() => setCurrentIndex(index)} onMouseEnter={() => setHoverState({ isHovering: true })} onMouseLeave={() => setHoverState({ isHovering: false })} className={`w-3 h-3 rounded-full border border-white transition-all duration-300 ${index === currentIndex ? 'bg-white scale-125' : 'bg-transparent hover:bg-white/50'}`} aria-label={`Go to slide ${index + 1}`} />))}</div>)}
    </div>
  );
};
const ProjectTags = ({ tags }) => {
  if (!tags) return null;
  const tagList = Array.isArray(tags) ? tags : String(tags).split(/, ?/);
  return (<div className="mt-6 flex justify-center gap-2 flex-wrap">{tagList.map(tag => (<span key={tag} className="inline-block bg-gray-100 text-gray-600 text-xs font-bold uppercase tracking-wider px-3 py-1 rounded-sm">{tag}</span>))}</div>);
};

// --- Block Components ---
const HeroBlock = ({ data }) => {
  if (!data.images || data.images.length === 0) return null;
  const { images, style } = data;
  if (style === 'trio') {
    return <div className="hidden md:grid grid-cols-3 gap-4 md:gap-8">{images.slice(0,3).map((img, i) => (<div key={i} className="relative overflow-hidden rounded-lg shadow-xl aspect-[16/9] sm:aspect-[16/27]"><img src={img.url} alt={img.alt} className="absolute inset-0 w-full h-full object-cover" /></div>))}</div>;
  }
  if (style === 'duo') {
    return <div className="hidden md:grid grid-cols-2 gap-4 md:gap-8 md:aspect-[16/9]">{images.slice(0,2).map((img, i) => (<div key={i} className="relative w-full aspect-[16/9] md:aspect-auto md:h-full overflow-hidden rounded-lg shadow-xl"><img src={img.url} alt={img.alt} className="w-full h-full object-cover" /></div>))}</div>;
  }
  return <div className="relative w-full aspect-[16/9] overflow-hidden rounded-lg shadow-xl"><img src={images[0].url} alt={images[0].alt} className="w-full h-full object-cover" /></div>;
};
const TitleBlock = ({ project }) => (
  <div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-2xl mt-12 md:mt-16 text-center">
    <h1 className="text-3xl sm:text-4xl md:text-5xl font-black text-slate-900 tracking-tighter uppercase">{project.title}</h1>
    {project.client && <p className="mt-2 text-lg md:text-xl font-medium text-brand-primary">{project.client}</p>}
    <ProjectTags tags={project.tags} />
  </div>
);
const TextBlock = ({ data }) => {
  return (
    <div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-2xl my-8 md:my-10">
      <div className="prose max-w-none mx-auto text-slate-600">
        {data.heading && <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-2">{data.heading}</h2>}
        {data.body && <p dangerouslySetInnerHTML={{ __html: data.body }}></p>}
      </div>
    </div>
  );
};
const ImageBlock = ({ data }) => {
  const { image, size = 'full', caption } = data;
  if (!image || !image.url) return null;
  const sizeClasses = {
    full: 'max-w-6xl',
    medium: 'max-w-4xl',
    small: 'max-w-xl'
  };
  return (
    <div className={`container mx-auto px-4 sm:px-6 lg:px-8 ${sizeClasses[size]} my-8 md:my-10`}>
      <figure>
        <div className="relative w-full aspect-[16/9] overflow-hidden rounded-lg shadow-xl">
          <img src={image.url} alt={image.alt} className="w-full h-full object-cover" />
        </div>
        {caption && <figcaption className="text-center text-sm text-slate-500 mt-3">{caption}</figcaption>}
      </figure>
    </div>
  );
};
const TextWithImagesBlock = ({ data }) => {
    const { heading, body, images, imagePosition = 'right' } = data;
    if (!body || !images || images.length === 0) return null;
    const textOrder = imagePosition === 'right' ? 'md:order-1' : 'md:order-2';
    const imageOrder = imagePosition === 'right' ? 'md:order-2' : 'md:order-1';
    const gridCols = images.length >= 2 ? 'grid-cols-2' : 'grid-cols-1';

    return (
        <div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl my-8 md:my-10">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12">
                <div className={`prose max-w-none mx-auto text-slate-600 ${textOrder}`}>
                    {heading && <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-2">{heading}</h2>}
                    <p dangerouslySetInnerHTML={{ __html: body }}></p>
                </div>
                <div className={`grid ${gridCols} gap-4 self-center ${imageOrder}`}>
                    {images.slice(0, 4).map((img, i) => (
                        <div key={i} className="aspect-square relative overflow-hidden rounded-lg shadow-md">
                            <img src={img.url} alt={img.alt} className="w-full h-full object-cover" />
                        </div>
                    ))}
                </div>
            </div>
        </div>
    );
};
const ImageGridBlock = ({ data }) => {
    if (!data.images || data.images.length === 0) return null;
    const gridClasses = {
        1: 'grid-cols-1',
        2: 'sm:grid-cols-2',
        3: 'sm:grid-cols-3',
        4: 'sm:grid-cols-2 md:grid-cols-4',
    };
    const numImages = data.images.length;
    const gridClass = gridClasses[numImages] || 'sm:grid-cols-3';

    return (
        <div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl my-8 md:my-10">
            <div className={`grid grid-cols-1 ${gridClass} gap-4 md:gap-8`}>
                {data.images.map((img, i) => (
                    <div key={i} className="overflow-hidden rounded-lg shadow-xl aspect-square">
                        <img src={img.url} alt={img.alt} className="w-full h-full object-cover" />
                    </div>
                ))}
            </div>
        </div>
    );
};
const CarouselBlock = ({ data }) => {
    if (!data.images || data.images.length === 0) return null;
    return (
        <div className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl my-8 md:my-10">
            <ProjectImageCarousel images={data.images} />
        </div>
    );
};

const CaseStudyDetailPage = ({ projectId }) => {
  const setHoverState = useContext(CursorHoverDispatchContext);
  const { heroProjects } = useContent();
  const project = heroProjects.find(p => p.id === projectId);
  const handleHomeClick = (e) => { e.preventDefault(); window.location.hash = '#/'; };

  if (!project) return (
    <div className="text-slate-900 py-20 bg-white"><div className="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h1 className="text-4xl font-bold text-base-dark">Project Not Found</h1><p className="mt-4 text-base-light">Sorry, we couldn't find the project you were looking for.</p>
      <a href="#/" onClick={handleHomeClick} onMouseEnter={() => setHoverState({ isHovering: true })} onMouseLeave={() => setHoverState({ isHovering: false })} className="mt-8 inline-block bg-brand-primary text-white font-bold py-3 px-8 rounded-lg transition-transform duration-300 hover:scale-105">Back to Home</a>
    </div></div>
  );
  
  const renderBlock = (block, index) => {
    switch (block.type) {
        case 'hero': return <header key={index} className="container mx-auto px-4 sm:px-6 lg:px-8 max-w-6xl mt-10 md:mt-20 relative group"><HeroBlock data={block.data} /><ProjectNavigation currentProjectId={project.id} projects={heroProjects} /></header>;
        case 'title': return <TitleBlock key={index} project={project} />;
        case 'text': return <TextBlock key={index} data={block.data} />;
        case 'image': return <ImageBlock key={index} data={block.data} />;
        case 'textWithImages': return <TextWithImagesBlock key={index} data={block.data} />;
        case 'imageGrid': return <ImageGridBlock key={index} data={block.data} />;
        case 'carousel': return <CarouselBlock key={index} data={block.data} />;
        default: return <div key={index} className="text-red-500 text-center py-4">Unknown block type: {block.type}</div>;
    }
  }

  return (
    <article className="text-slate-800 animate-fade-in-up bg-white pb-10">
      {(project.contentBlocks && project.contentBlocks.length > 0) 
        ? project.contentBlocks.map(renderBlock)
        : <div className="text-center py-20">This project has no content yet.</div>
      }
    </article>
  );
};

const AdminPage = () => {
    const { 
        aboutMe, heroProjects, clientLogos, brandLogos, 
        updateAboutMe, updateHeroProjects, updateLogos,
        resetToDefaults, isFirebaseActive 
    } = useContent();
    const [isAuthenticated, setIsAuthenticated] = useState(false);
    const [email, setEmail] = useState('');
    const [password, setPassword] = useState('');
    const [error, setError] = useState('');
    const [loading, setLoading] = useState(true);
    const [activeTab, setActiveTab] = useState('projects');

    useEffect(() => {
        document.body.style.cursor = 'default';
        return () => { document.body.style.cursor = ''; }
    }, []);

    useEffect(() => {
        if (auth) {
            const unsubscribe = onAuthStateChanged(auth, (user) => { setIsAuthenticated(!!user); setLoading(false); });
            return () => unsubscribe();
        } else { setLoading(false); }
    }, []);

    const handleLogin = async (e) => {
        e.preventDefault(); setError('');
        if (!auth) { setError("Firebase is not configured. Cannot log in."); return; }
        try { await signInWithEmailAndPassword(auth, email, password); } catch (err) { setError(err.message); }
    };
    const handleLogout = async () => { if (auth) await signOut(auth); };

    // --- Admin UI Components ---
    const inputClasses = "appearance-none border border-base-light rounded w-full py-2 px-3 bg-base-dark text-text-primary leading-tight focus:outline-none focus:ring-2 focus:ring-brand-primary";
    const labelClasses = "block text-text-secondary text-sm font-bold mb-2";
    const buttonClasses = "bg-brand-primary hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-colors disabled:opacity-50";
    const AdminInput = ({ label, name, value, onChange, recommendation, ...props }) => (
        <div><label htmlFor={name} className={labelClasses}>{label}</label>{recommendation && <p className="text-xs text-text-tertiary mb-1" dangerouslySetInnerHTML={{__html: recommendation}}></p>}<input id={name} name={name} value={value} onChange={onChange} className={inputClasses} {...props} /></div>
    );
    const AdminTextarea = ({ label, name, value, onChange, rows = 3, placeholder = '', recommendation }) => (
        <div><label htmlFor={name} className={labelClasses}>{label}</label>{recommendation && <p className="text-xs text-text-tertiary mb-1" dangerouslySetInnerHTML={{__html: recommendation}}></p>}<textarea id={name} name={name} value={value} onChange={onChange} rows={rows} className={inputClasses} placeholder={placeholder} /></div>
    );
    const AdminSelect = ({ label, name, value, onChange, children }) => (
        <div><label htmlFor={name} className={labelClasses}>{label}</label><select id={name} name={name} value={value} onChange={onChange} className={inputClasses}>{children}</select></div>
    );
    const AdminSection = ({ title, children, gridCols = 'md:grid-cols-2' }) => (
        <div className="bg-base-medium p-6 rounded-lg shadow-lg mb-8"><h3 className="text-xl font-bold text-text-primary border-b border-base-light pb-3 mb-4">{title}</h3><div className={`grid grid-cols-1 ${gridCols} gap-6`}>{children}</div></div>
    );
    const AdminImageInput = ({ label, name, value, onChange, recommendation }) => (
        <div className="space-y-2">
            <AdminInput label={`${label} URL`} name={`${name}-url`} value={value?.url || ''} onChange={e => onChange({ ...value, url: e.target.value })} placeholder="https://..." recommendation={recommendation} />
            <AdminInput label={`${label} SEO Text`} name={`${name}-alt`} value={value?.alt || ''} onChange={e => onChange({ ...value, alt: e.target.value })} placeholder="SEO-friendly description for the image" />
        </div>
    );
    const AdminImageArrayInput = ({ label, value, onChange, recommendation }) => {
        const handleItemChange = (index, newValue) => { const updated = [...value]; updated[index] = newValue; onChange(updated); };
        const handleAddItem = () => onChange([...(value || []), { url: '', alt: '' }]);
        const handleRemoveItem = (index) => onChange(value.filter((_, i) => i !== index));

        return (
            <div className="md:col-span-2 space-y-4">
                <label className={labelClasses}>{label}</label>
                {recommendation && <p className="text-xs text-text-tertiary mb-2" dangerouslySetInnerHTML={{__html: recommendation}}></p>}
                {(value || []).map((item, index) => (
                    <div key={index} className="grid grid-cols-1 md:grid-cols-[1fr_1fr_auto] gap-4 items-end bg-base-dark p-4 rounded-md">
                        <AdminInput label={`URL ${index + 1}`} value={item.url} onChange={e => handleItemChange(index, { ...item, url: e.target.value })} />
                        <AdminInput label={`SEO Text ${index + 1}`} value={item.alt} onChange={e => handleItemChange(index, { ...item, alt: e.target.value })} />
                        <button onClick={() => handleRemoveItem(index)} className="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded h-10 mb-1">X</button>
                    </div>
                ))}
                <button onClick={handleAddItem} className={buttonClasses + " mt-2 w-full md:w-auto"}>Add Image</button>
            </div>
        );
    };
    
    const TabButton = ({ label, tabName, danger = false }) => (
        <button 
            onClick={() => setActiveTab(tabName)} 
            className={`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors focus:outline-none ${
                activeTab === tabName 
                    ? (danger ? 'bg-red-900/50 text-red-400' : 'bg-base-medium text-brand-primary') 
                    : (danger ? 'text-red-500 hover:text-red-400 hover:bg-red-900/30' : 'text-text-secondary hover:text-text-primary')
            }`}
        >
            {label}
        </button>
    );

    // --- Tab Content Components ---
    const ThemeGeneralSettings = () => {
        const [data, setData] = useState(aboutMe);
        useEffect(() => setData(aboutMe), [aboutMe]);
        const handleChange = (e) => { const { name, value } = e.target; setData(prev => ({ ...prev, [name]: value })); };
        const handleSave = () => { updateAboutMe(data); alert('Settings saved!'); };

        const handleSocialLinkChange = (index, field, value) => { const updated = [...(data.socialLinks || [])]; updated[index][field] = value; setData(prev => ({ ...prev, socialLinks: updated })); };
        const addSocialLink = () => setData(p => ({...p, socialLinks: [...(p.socialLinks || []), {iconUrl: '', linkUrl: ''}]}));
        const removeSocialLink = (index) => setData(p => ({...p, socialLinks: p.socialLinks.filter((_, i) => i !== index)}));

        return (
            <div>
                <div className="sticky top-0 bg-base-dark/80 backdrop-blur-sm z-10 py-4 mb-4 flex justify-end"><button onClick={handleSave} className={buttonClasses}>Save Settings</button></div>
                <AdminSection title="General Information">
                    <AdminInput label="Header Logo Text" name="logoText" value={data.logoText} onChange={handleChange} />
                    <AdminImageInput label="Header Icon" name="headerIcon" value={data.headerIcon} onChange={value => setData(prev => ({...prev, headerIcon: value}))} />
                    <AdminInput label="Email" name="email" value={data.email} onChange={handleChange} />
                    <AdminInput label="Phone" name="phone" value={data.phone} onChange={handleChange} />
                </AdminSection>
                 <AdminSection title="Social Media Links" gridCols="md:grid-cols-1">
                    {(data.socialLinks || []).map((item, index) => (
                      <div key={index} className="grid grid-cols-1 md:grid-cols-[1fr_1fr_auto] gap-4 items-end bg-base-dark p-4 rounded-md">
                        <AdminInput label={`Icon URL ${index + 1}`} value={item.iconUrl} onChange={e => handleSocialLinkChange(index, 'iconUrl', e.target.value)} placeholder="URL or 'linkedin'" recommendation="Use 'linkedin' for the default icon, otherwise provide a full image URL." />
                        <AdminInput label={`Link URL ${index + 1}`} value={item.linkUrl} onChange={e => handleSocialLinkChange(index, 'linkUrl', e.target.value)} placeholder="https://..." />
                        <button onClick={() => removeSocialLink(index)} className="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded h-10 mb-1">X</button>
                      </div>
                    ))}
                    <button onClick={addSocialLink} className={buttonClasses + " mt-2 w-full md:w-auto"}>Add Social Link</button>
                 </AdminSection>
                 <AdminSection title="Theme Colors">
                    <div className="flex items-center gap-4"><AdminInput type="color" label="Primary Brand Color" name="brandPrimary" value={data.brandPrimary || '#0891b2'} onChange={handleChange} className="p-1 h-10 w-14 block bg-white border border-gray-200 cursor-pointer rounded-lg disabled:opacity-50 disabled:pointer-events-none" /><span className="text-text-secondary">{data.brandPrimary}</span></div>
                    <div className="flex items-center gap-4"><AdminInput type="color" label="Secondary Brand Color" name="brandSecondary" value={data.brandSecondary || '#f0f9ff'} onChange={handleChange} className="p-1 h-10 w-14 block bg-white border border-gray-200 cursor-pointer rounded-lg disabled:opacity-50 disabled:pointer-events-none" /><span className="text-text-secondary">{data.brandSecondary}</span></div>
                    <div className="flex items-center gap-4"><AdminInput type="color" label="Header Background Color" name="headerBgColor" value={data.headerBgColor || '#0f172a'} onChange={handleChange} className="p-1 h-10 w-14 block bg-white border border-gray-200 cursor-pointer rounded-lg disabled:opacity-50 disabled:pointer-events-none" /><span className="text-text-secondary">{data.headerBgColor}</span></div>
                    <div className="flex items-center gap-4"><AdminInput type="color" label="Hero Background Color" name="heroBgColor" value={data.heroBgColor || '#0f172a'} onChange={handleChange} className="p-1 h-10 w-14 block bg-white border border-gray-200 cursor-pointer rounded-lg disabled:opacity-50 disabled:pointer-events-none" /><span className="text-text-secondary">{data.heroBgColor}</span></div>
                </AdminSection>
            </div>
        );
    };

    const HomePageSettings = () => {
        const [data, setData] = useState(aboutMe);
        useEffect(() => setData(aboutMe), [aboutMe]);
        const handleChange = (e) => { const { name, value } = e.target; setData(prev => ({ ...prev, [name]: value })); };
        const handleSave = () => { updateAboutMe(data); alert('Home page saved!'); };
        return (
            <div>
                <div className="sticky top-0 bg-base-dark/80 backdrop-blur-sm z-10 py-4 mb-4 flex justify-end"><button onClick={handleSave} className={buttonClasses}>Save Home Page</button></div>
                <AdminSection title="Hero Content" gridCols="md:grid-cols-1">
                    <AdminInput label="Name" name="name" value={data.name} onChange={handleChange} />
                    <AdminInput label="Title" name="title" value={data.title} onChange={handleChange} />
                    <AdminTextarea label="Hero Intro" name="heroIntro" value={data.heroIntro} onChange={handleChange} rows={4} />
                </AdminSection>
            </div>
        );
    };

    const AboutPageSettings = () => {
        const [data, setData] = useState(aboutMe);
        useEffect(() => setData(aboutMe), [aboutMe]);

        const handleChange = (e) => { const { name, value } = e.target; setData(prev => ({ ...prev, [name]: value })); };
        const handleListChange = (e) => { const { name, value } = e.target; setData(prev => ({ ...prev, [name]: value.split('\n').map(s => s.trim()).filter(Boolean) })); };
        const handleSave = () => { updateAboutMe(data); alert('About page saved!'); };
        
        const handlePhilosophyChange = (index, field, value) => { const updated = [...data.philosophy]; updated[index][field] = value; setData(prev => ({ ...prev, philosophy: updated })); };
        const addPhilosophy = () => setData(p => ({...p, philosophy: [...p.philosophy, {title: '', text: ''}]}));
        const removePhilosophy = (index) => setData(p => ({...p, philosophy: p.philosophy.filter((_, i) => i !== index)}));

        const handleHeadingsChange = (e) => { const { name, value } = e.target; setData(prev => ({ ...prev, pageHeadings: { ...prev.pageHeadings, [name]: value } })); };
        const handleTravelLogChange = (index, field, value) => { const updated = [...data.travelLog]; updated[index][field] = value; setData(prev => ({ ...prev, travelLog: updated })); };
        const addTravelLogItem = () => setData(p => ({...p, travelLog: [...(p.travelLog || []), {text: '', completed: false}]}));
        const removeTravelLogItem = (index) => setData(p => ({...p, travelLog: p.travelLog.filter((_, i) => i !== index)}));
        const handleFavoritesChange = (e) => {
          const { name, value } = e.target;
          setData(prev => ({ ...prev, favorites: { ...prev.favorites, [name]: value.split('\n').map(s => s.trim()).filter(Boolean) } }));
        };

        return (
            <div>
                 <div className="sticky top-0 bg-base-dark/80 backdrop-blur-sm z-10 py-4 mb-4 flex justify-end"><button onClick={handleSave} className={buttonClasses}>Save About Page</button></div>
                 <AdminSection title="Intro Content" gridCols="md:grid-cols-1">
                    <AdminTextarea label="Intro Statement (About Page)" name="introStatement" value={data.introStatement} onChange={handleChange} rows={4} recommendation="Use <b>bold text</b> for emphasis." />
                 </AdminSection>
                  <AdminSection title="Page Titles & Subtitles">
                    <AdminInput label="Main Title" name="aboutTitle" value={data.pageHeadings.aboutTitle} onChange={handleHeadingsChange} recommendation="Use <br/> for line breaks and <span> for styling." />
                    <AdminInput label="Philosophy Subtitle" name="philosophySubtitle" value={data.pageHeadings.philosophySubtitle} onChange={handleHeadingsChange} recommendation="Use <br/> for line breaks."/>
                    <AdminInput label="'Obsessed With' Title" name="obsessionsTitle" value={data.pageHeadings.obsessionsTitle} onChange={handleHeadingsChange} />
                    <AdminInput label="'Bucket List' Title" name="bucketListTitle" value={data.pageHeadings.bucketListTitle} onChange={handleHeadingsChange} />
                    <AdminInput label="'Media Diet' Title" name="mediaDietTitle" value={data.pageHeadings.mediaDietTitle} onChange={handleHeadingsChange} />
                </AdminSection>
                <AdminSection title="Media Diet Categories">
                    <AdminInput label="Movies Title" name="mediaDietMovies" value={data.pageHeadings.mediaDietMovies} onChange={handleHeadingsChange} />
                    <AdminInput label="Shows Title" name="mediaDietShows" value={data.pageHeadings.mediaDietShows} onChange={handleHeadingsChange} />
                    <AdminInput label="Podcasts Title" name="mediaDietPodcasts" value={data.pageHeadings.mediaDietPodcasts} onChange={handleHeadingsChange} />
                    <AdminInput label="Audiobooks Title" name="mediaDietAudiobooks" value={data.pageHeadings.mediaDietAudiobooks} onChange={handleHeadingsChange} />
                </AdminSection>
                 <AdminSection title="Philosophy" gridCols="md:grid-cols-1">
                    {data.philosophy.map((item, index) => (
                      <div key={index} className="grid grid-cols-1 md:grid-cols-[1fr_2fr_auto] gap-4 items-end bg-base-dark p-4 rounded-md">
                        <AdminInput label={`Title ${index + 1}`} value={item.title} onChange={e => handlePhilosophyChange(index, 'title', e.target.value)} />
                        <AdminTextarea label={`Text ${index + 1}`} value={item.text} onChange={e => handlePhilosophyChange(index, 'text', e.target.value)} rows={2} recommendation="Use <b>bold text</b> for emphasis."/>
                        <button onClick={() => removePhilosophy(index)} className="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded h-10 mb-1">X</button>
                      </div>
                    ))}
                    <button onClick={addPhilosophy} className={buttonClasses + " mt-2 w-full md:w-auto"}>Add Philosophy Point</button>
                 </AdminSection>
                 <AdminSection title="Obsessions List">
                    <AdminTextarea label="Obsessions (one item per line)" name="obsessions" value={(data.obsessions || []).join('\n')} onChange={handleListChange} rows={6} />
                 </AdminSection>
                 <AdminSection title="Bucket List" gridCols="md:grid-cols-1">
                    {(data.travelLog || []).map((item, index) => (
                      <div key={index} className="grid grid-cols-[1fr_auto_auto] gap-4 items-center bg-base-dark p-4 rounded-md">
                        <AdminInput label={`Item ${index + 1}`} value={item.text} onChange={e => handleTravelLogChange(index, 'text', e.target.value)} />
                        <div className="flex items-center h-full pt-8">
                          <input type="checkbox" checked={!!item.completed} onChange={e => handleTravelLogChange(index, 'completed', e.target.checked)} className="h-5 w-5 rounded text-brand-primary focus:ring-brand-primary bg-base-light border-base-light" />
                          <label className="ml-2 text-text-secondary">Completed</label>
                        </div>
                        <button onClick={() => removeTravelLogItem(index)} className="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded h-10 self-end mb-1">X</button>
                      </div>
                    ))}
                    <button onClick={addTravelLogItem} className={buttonClasses + " mt-2 w-full md:w-auto"}>Add Bucket List Item</button>
                </AdminSection>
                <AdminSection title="Media Diet Lists">
                    <AdminTextarea label="Movies (one per line)" name="movies" value={(data.favorites.movies || []).join('\n')} onChange={handleFavoritesChange} rows={4} />
                    <AdminTextarea label="Shows (one per line)" name="shows" value={(data.favorites.shows || []).join('\n')} onChange={handleFavoritesChange} rows={4} />
                    <AdminTextarea label="Podcasts (one per line)" name="podcasts" value={(data.favorites.podcasts || []).join('\n')} onChange={handleFavoritesChange} rows={4} />
                    <AdminTextarea label="Audiobooks (one per line)" name="audiobooks" value={(data.favorites.audiobooks || []).join('\n')} onChange={handleFavoritesChange} rows={4} />
                </AdminSection>
                 <AdminSection title="Inspiration Images" gridCols="md:grid-cols-1">
                    <AdminImageInput label="Panorama Image" name="panorama" value={data.panorama} onChange={v => setData(p => ({...p, panorama: v}))} recommendation="Compress images with TinyPNG or Squoosh. Recommended size: 2000x600px." />
                    <AdminImageArrayInput label="Inspiration Grid Images (6 recommended)" value={data.inspirationGrid} onChange={v => setData(p => ({...p, inspirationGrid: v}))} recommendation="Compress images with TinyPNG or Squoosh. Recommended size: 1200x800px." />
                 </AdminSection>
            </div>
        );
    };

    const ProjectEditor = () => {
        const [projects, setProjects] = useState(heroProjects);
        const [editingProject, setEditingProject] = useState(null);
        useEffect(() => setProjects(heroProjects), [heroProjects]);
        
        const handleAddNew = () => setEditingProject({ id: `new-project-${Date.now()}`, title: 'New Project', subtitle: '', client: '', tags: [], heroImage: {url:'', alt:''}, homePageTitle: '', homePageSubtitle: '', homePageImage: {url:'', alt:''}, contentBlocks: [] });
        const handleEdit = (project) => setEditingProject(JSON.parse(JSON.stringify(project)));
        const handleDelete = (id) => { if (confirm('Are you sure? This action cannot be undone.')) { const updated = projects.filter(p => p.id !== id); setProjects(updated); updateHeroProjects(updated); } };
        const handleSave = (projectToSave) => {
            const index = projects.findIndex(p => p.id === projectToSave.id);
            let updated;
            if (index > -1) {
                updated = [...projects]; updated[index] = projectToSave;
            } else { updated = [...projects, projectToSave]; }
            setProjects(updated); updateHeroProjects(updated); setEditingProject(null); alert('Project saved!');
        };
        
        if (editingProject) {
            return <ProjectBuilder initialProject={editingProject} onSave={handleSave} onCancel={() => setEditingProject(null)} />;
        }

        return (
            <div>
                <div className="flex justify-between items-center mb-4">
                    <h2 className="text-2xl font-bold">Manage Projects</h2>
                    <button onClick={handleAddNew} className={buttonClasses}>Add New Project</button>
                </div>
                <div className="bg-base-medium rounded-lg shadow-lg">
                    <ul className="divide-y divide-base-light">{projects.map(p => (
                        <li key={p.id} className="p-4 flex justify-between items-center">
                            <div><p className="font-bold text-text-primary">{p.title}</p><p className="text-sm text-text-tertiary">{p.id}</p></div>
                            <div className="flex gap-2">
                                <button onClick={() => handleEdit(p)} className="text-sm bg-base-light hover:bg-brand-primary text-white font-bold py-1 px-3 rounded">Edit</button>
                                <button onClick={() => handleDelete(p.id)} className="text-sm bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-3 rounded">Delete</button>
                            </div>
                        </li>
                    ))}</ul>
                </div>
            </div>
        );
    };

    const ProjectBuilder = ({ initialProject, onSave, onCancel }) => {
        const [project, setProject] = useState(initialProject);
        const [editingBlock, setEditingBlock] = useState({ block: null, index: -1 });

        const handleProjectChange = (e) => { const { name, value } = e.target; setProject(p => ({ ...p, [name]: value })); };
        const handleTagChange = (e) => { const { value } = e.target; setProject(p => ({ ...p, tags: value.split(/[\n,]+/).map(s => s.trim()).filter(Boolean) })); };
        
        const addBlock = (type) => {
            const newBlock = { type, data: {} };
            // Set default data structures for block types
            switch(type) {
                case 'hero': newBlock.data = { images: [], style: 'single' }; break;
                case 'text': newBlock.data = { heading: '', body: '' }; break;
                case 'textWithImages': newBlock.data = { heading: '', body: '', images: [], imagePosition: 'right' }; break;
                case 'image': newBlock.data = { image: { url: '', alt: '' }, size: 'full', caption: '' }; break;
                case 'imageGrid': case 'carousel': newBlock.data = { images: [] }; break;
            }
            setProject(p => ({ ...p, contentBlocks: [...(p.contentBlocks || []), newBlock] }));
        };
        
        const updateBlock = (index, updatedBlock) => {
            const updatedBlocks = [...project.contentBlocks];
            updatedBlocks[index] = updatedBlock;
            setProject(p => ({ ...p, contentBlocks: updatedBlocks }));
            setEditingBlock({ block: null, index: -1 });
        };
        
        const removeBlock = (index) => {
            if (confirm('Delete this content block?')) {
                setProject(p => ({...p, contentBlocks: p.contentBlocks.filter((_, i) => i !== index)}));
            }
        };

        const moveBlock = (index, direction) => {
            const newIndex = index + direction;
            if (newIndex < 0 || newIndex >= project.contentBlocks.length) return;
            const updatedBlocks = [...project.contentBlocks];
            const item = updatedBlocks.splice(index, 1)[0];
            updatedBlocks.splice(newIndex, 0, item);
            setProject(p => ({ ...p, contentBlocks: updatedBlocks }));
        };
        
        const BlockTypeIcon = ({ type }) => {
            const icons = {
                hero: 'M4 16l-2-2 8-8 8 8-2 2H4z',
                title: 'M3 12h3v7h3v-7h3V9H3v3zm10-5h-1v6h1V7zm3-2h-1v8h1V5zm3 2h-1v6h1V7z',
                text: 'M4 6h16M4 12h16M4 18h16',
                textWithImages: 'M4 4h7v7H4V4zm10 0h7v7h-7V4zM4 15h7v7H4v-7zm10 0h7v7h-7v-7z',
                image: 'M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z',
                imageGrid: 'M4 4h7v7H4V4zm10 0h7v7h-7V4zM4 15h7v7H4v-7zm10 0h7v7h-7v-7z',
                carousel: 'M6 5h2v14H6V5zm10 0h2v14h-2V5z'
            };
            return <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-3 text-text-tertiary" viewBox="0 0 24 24" fill="currentColor"><path d={icons[type] || 'M0 0h24v24H0z'} /></svg>;
        };

        return (
            <div className="bg-base-dark p-6 rounded-lg shadow-lg">
                 <div className="flex justify-between items-center mb-6">
                    <h3 className="text-xl font-bold">{project.id.startsWith('new') ? 'Add New Project' : 'Edit Project'}</h3>
                    <div className="flex gap-4">
                        <button onClick={() => onSave(project)} className={buttonClasses}>Save Project</button>
                        <button onClick={onCancel} className="bg-base-light hover:bg-base-medium text-text-primary font-bold py-2 px-4 rounded">Cancel</button>
                    </div>
                </div>
                <div className="flex flex-col lg:flex-row gap-8">
                    {/* Left Column: Core Info & Content Blocks */}
                    <div className="flex-grow lg:w-2/3">
                        <AdminSection title="Core Info">
                            <AdminInput label="ID (slug, no spaces)" name="id" value={project.id} onChange={handleProjectChange} />
                            <AdminInput label="Title" name="title" value={project.title} onChange={handleProjectChange} />
                            <AdminInput label="Client" name="client" value={project.client} onChange={handleProjectChange} />
                            <div className="md:col-span-2">
                               <AdminTextarea label="Project Types / Tags (one per line or comma-separated)" name="tags" value={(project.tags || []).join('\n')} onChange={handleTagChange} rows={2} recommendation="e.g., Packaging, Broadcast TV, Retail, Brand Identity"/>
                            </div>
                        </AdminSection>
                        <AdminSection title="Homepage Display (Optional)">
                            <AdminInput label="Homepage Title" name="homePageTitle" value={project.homePageTitle || ''} onChange={handleProjectChange} placeholder="Defaults to main project title" />
                            <AdminInput label="Homepage Subtitle" name="homePageSubtitle" value={project.homePageSubtitle || ''} onChange={handleProjectChange} placeholder="Defaults to main project subtitle" />
                            <div className="md:col-span-2"><AdminImageInput label="Homepage Image" name="homePageImage" value={project.homePageImage} onChange={v => setProject(p => ({...p, homePageImage: v}))} /></div>
                        </AdminSection>
                        <AdminSection title="Content Blocks" gridCols="md:grid-cols-1">
                            <div className="space-y-2">
                                {(project.contentBlocks || []).map((block, index) => (
                                    <div key={index} className="flex items-center justify-between bg-base-dark p-2 rounded-md border border-base-light">
                                        <div className="flex items-center">
                                            <BlockTypeIcon type={block.type} />
                                            <span className="font-medium text-text-secondary capitalize">{block.type.replace(/([A-Z])/g, ' $1')}</span>
                                            <span className="text-sm text-text-tertiary ml-4 truncate">{block.data.heading || block.data.caption || ''}</span>
                                        </div>
                                        <div className="flex items-center gap-1">
                                            <button onClick={() => moveBlock(index, -1)} disabled={index === 0} className="p-1 disabled:opacity-30"><svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clipRule="evenodd" /></svg></button>
                                            <button onClick={() => moveBlock(index, 1)} disabled={index === project.contentBlocks.length - 1} className="p-1 disabled:opacity-30"><svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clipRule="evenodd" /></svg></button>
                                            <button onClick={() => setEditingBlock({ block, index })} className="text-sm bg-base-light hover:bg-brand-primary text-white font-bold py-1 px-3 rounded">Edit</button>
                                            <button onClick={() => removeBlock(index)} className="text-sm bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-3 rounded">Del</button>
                                        </div>
                                    </div>
                                ))}
                                {(!project.contentBlocks || project.contentBlocks.length === 0) && <p className="text-center text-text-tertiary p-4">No content blocks yet. Add one from the right panel.</p>}
                            </div>
                        </AdminSection>
                    </div>
                     {/* Right Column: Add Block */}
                    <div className="lg:w-1/3">
                        <div className="sticky top-24 bg-base-medium p-4 rounded-lg shadow-lg">
                            <h3 className="font-bold mb-4">Add Content Block</h3>
                            <div className="grid grid-cols-2 gap-2">
                                <button onClick={() => addBlock('hero')} className="bg-base-light hover:bg-brand-primary p-2 rounded text-sm">Hero</button>
                                <button onClick={() => addBlock('title')} className="bg-base-light hover:bg-brand-primary p-2 rounded text-sm">Title</button>
                                <button onClick={() => addBlock('text')} className="bg-base-light hover:bg-brand-primary p-2 rounded text-sm">Text</button>
                                <button onClick={() => addBlock('textWithImages')} className="bg-base-light hover:bg-brand-primary p-2 rounded text-sm">Text + Images</button>
                                <button onClick={() => addBlock('image')} className="bg-base-light hover:bg-brand-primary p-2 rounded text-sm">Single Image</button>
                                <button onClick={() => addBlock('imageGrid')} className="bg-base-light hover:bg-brand-primary p-2 rounded text-sm">Image Grid</button>
                                <button onClick={() => addBlock('carousel')} className="bg-base-light hover:bg-brand-primary p-2 rounded text-sm">Carousel</button>
                            </div>
                        </div>
                    </div>
                </div>

                {editingBlock.block && (
                    <BlockEditorModal 
                        block={editingBlock.block} 
                        onSave={(updatedBlock) => updateBlock(editingBlock.index, updatedBlock)}
                        onClose={() => setEditingBlock({ block: null, index: -1 })}
                    />
                )}
            </div>
        );
    };

    const BlockEditorModal = ({ block, onSave, onClose }) => {
        const [editedBlock, setEditedBlock] = useState(JSON.parse(JSON.stringify(block)));

        const handleChange = (e) => {
            const { name, value } = e.target;
            setEditedBlock(b => ({ ...b, data: { ...b.data, [name]: value } }));
        };
        const handleImageChange = (value) => {
            setEditedBlock(b => ({ ...b, data: { ...b.data, image: value } }));
        };
        const handleImageArrayChange = (value) => {
            setEditedBlock(b => ({ ...b, data: { ...b.data, images: value } }));
        };
        const handleSave = () => onSave(editedBlock);

        const renderForm = () => {
            switch (block.type) {
                case 'hero': return (
                    <div className="space-y-4">
                        <AdminSelect label="Style" name="style" value={editedBlock.data.style} onChange={handleChange}>
                            <option value="single">Single Full Image</option><option value="duo">Two-Column</option><option value="trio">Three-Column</option>
                        </AdminSelect>
                        <AdminImageArrayInput label="Images" value={editedBlock.data.images} onChange={handleImageArrayChange} recommendation="1 image for Single, 2 for Duo, 3 for Trio."/>
                    </div>
                );
                case 'title': return <p className="text-text-tertiary">This block has no editable content. It automatically displays the project's title, client, and tags.</p>;
                case 'text': return (
                    <div className="space-y-4">
                        <AdminInput label="Heading (Optional)" name="heading" value={editedBlock.data.heading} onChange={handleChange} />
                        <AdminTextarea label="Body Text" name="body" value={editedBlock.data.body} onChange={handleChange} rows={8} recommendation="Use HTML for styling (e.g., &lt;b&gt; for bold)." />
                    </div>
                );
                case 'textWithImages': return (
                    <div className="space-y-4">
                        <AdminInput label="Heading (Optional)" name="heading" value={editedBlock.data.heading} onChange={handleChange} />
                        <AdminTextarea label="Body Text" name="body" value={editedBlock.data.body} onChange={handleChange} rows={6} recommendation="Use HTML for styling." />
                        <AdminSelect label="Image Position" name="imagePosition" value={editedBlock.data.imagePosition} onChange={handleChange}>
                            <option value="right">Right</option><option value="left">Left</option>
                        </AdminSelect>
                        <AdminImageArrayInput label="Images (up to 4)" value={editedBlock.data.images} onChange={handleImageArrayChange} recommendation="Recommended size: 400x400px (square)."/>
                    </div>
                );
                case 'image': return (
                     <div className="space-y-4">
                        <AdminImageInput label="Image" value={editedBlock.data.image} onChange={handleImageChange} />
                        <AdminSelect label="Size" name="size" value={editedBlock.data.size} onChange={handleChange}>
                            <option value="full">Full Width</option><option value="medium">Medium</option><option value="small">Small</option>
                        </AdminSelect>
                        <AdminInput label="Caption (Optional)" name="caption" value={editedBlock.data.caption} onChange={handleChange} />
                        <div className="text-xs text-text-tertiary p-3 bg-base-dark rounded-md"><b>Size Guide:</b><br/>Full: ~1920px wide, Medium: ~1200px wide, Small: ~800px wide. Use 16:9 aspect ratio.</div>
                    </div>
                );
                 case 'imageGrid': case 'carousel': return (
                    <div className="space-y-4">
                        <AdminImageArrayInput label="Images" value={editedBlock.data.images} onChange={handleImageArrayChange} recommendation="Grid: Use square images (e.g. 800x800). Carousel: use 16:9 images (e.g. 1200x675)." />
                    </div>
                );
                default: return <p>Unknown block type.</p>
            }
        };

        return (
            <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in-up" style={{animationDuration: '300ms'}}>
                <div className="bg-base-medium rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                    <header className="p-4 border-b border-base-light flex justify-between items-center">
                        <h3 className="text-xl font-bold">Edit: <span className="capitalize">{block.type.replace(/([A-Z])/g, ' $1')}</span></h3>
                        <button onClick={onClose} className="text-2xl">&times;</button>
                    </header>
                    <main className="p-6 overflow-y-auto">{renderForm()}</main>
                    <footer className="p-4 border-t border-base-light flex justify-end gap-4">
                        <button onClick={onClose} className="bg-base-light hover:bg-base-medium text-text-primary font-bold py-2 px-4 rounded">Cancel</button>
                        <button onClick={handleSave} className={buttonClasses}>Save Block</button>
                    </footer>
                </div>
            </div>
        );
    };

    const DraggableLogoGrid = ({ logos, onUpdate, onRemove }) => {
        const [dragging, setDragging] = useState(false);
        const dragItem = useRef();
        const dragOverItem = useRef();

        const handleDragStart = (e, index) => { dragItem.current = index; setDragging(true); e.dataTransfer.effectAllowed = 'move'; e.currentTarget.classList.add('logo-dragging'); };
        const handleDragEnter = (e, index) => { dragOverItem.current = index; };
        const handleDragEnd = (e) => {
            const newList = [...logos];
            const draggedItemContent = newList[dragItem.current];
            newList.splice(dragItem.current, 1);
            newList.splice(dragOverItem.current, 0, draggedItemContent);
            dragItem.current = null;
            dragOverItem.current = null;
            onUpdate(newList);
            setDragging(false);
            e.currentTarget.classList.remove('logo-dragging');
        };

        return (
            <div className="flex flex-wrap gap-4">
                {logos.map((logo, index) => (
                    <div key={index} draggable onDragStart={(e) => handleDragStart(e, index)} onDragEnter={(e) => handleDragEnter(e, index)} onDragEnd={handleDragEnd} onDragOver={e => e.preventDefault()} className="group relative w-48 h-16 bg-white p-2 rounded-md flex items-center justify-center cursor-move transition-all duration-300 border border-base-light">
                        <img src={logo} alt={`logo ${index}`} className="max-w-full max-h-full object-contain" />
                        <button onClick={() => onRemove(index)} className="absolute -top-2 -right-2 w-6 h-6 bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-sm font-bold">X</button>
                    </div>
                ))}
            </div>
        );
    };

    const LogoEditor = () => {
        const [localClientLogos, setLocalClientLogos] = useState(clientLogos);
        const [localBrandLogos, setLocalBrandLogos] = useState(brandLogos);
        const [newClientLogo, setNewClientLogo] = useState('');
        const [newBrandLogo, setNewNewBrandLogo] = useState('');

        useEffect(() => { setLocalClientLogos(clientLogos); setLocalBrandLogos(brandLogos); }, [clientLogos, brandLogos]);

        const handleSave = () => { 
            updateLogos(localClientLogos, localBrandLogos); 
            alert('Logos saved!'); 
        };
        const addLogo = (type) => {
            if (type === 'client' && newClientLogo) { setLocalClientLogos([...localClientLogos, newClientLogo]); setNewClientLogo(''); }
            if (type === 'brand' && newBrandLogo) { setLocalBrandLogos([...localBrandLogos, newBrandLogo]); setNewNewBrandLogo(''); }
        };
        const removeLogo = (type, index) => {
            if (type === 'client') { setLocalClientLogos(localClientLogos.filter((_, i) => i !== index)); }
            if (type === 'brand') { setLocalBrandLogos(localBrandLogos.filter((_, i) => i !== index)); }
        };

        return (
            <div>
                 <div className="sticky top-0 bg-base-dark/80 backdrop-blur-sm z-10 py-4 mb-4 flex justify-end"><button onClick={handleSave} className={buttonClasses}>Save Logos</button></div>
                 <AdminSection title="Client Logos" gridCols="md:grid-cols-1">
                    <DraggableLogoGrid logos={localClientLogos} onUpdate={setLocalClientLogos} onRemove={(index) => removeLogo('client', index)} />
                    <div className="flex gap-2 mt-4"><AdminInput label="Add New Client Logo URL" value={newClientLogo} onChange={(e) => setNewClientLogo(e.target.value)} placeholder="https://firebasestorage.googleapis.com/v0/b/your-project.appspot.com/o/file.jpg?alt=media&token=..." recommendation="In Firebase Storage, click the file, then copy the full 'Download URL' from the 'File location' panel. It must start with `https://firebasestorage.googleapis.com/...` and include an access token. A `gs://` link will not work." /><button onClick={() => addLogo('client')} className={buttonClasses + " self-end"}>Add</button></div>
                 </AdminSection>
                 <AdminSection title="Brand Logos" gridCols="md:grid-cols-1">
                    <DraggableLogoGrid logos={localBrandLogos} onUpdate={setLocalBrandLogos} onRemove={(index) => removeLogo('brand', index)} />
                    <div className="flex gap-2 mt-4"><AdminInput label="Add New Brand Logo URL" value={newBrandLogo} onChange={(e) => setNewNewBrandLogo(e.target.value)} placeholder="https://firebasestorage.googleapis.com/v0/b/your-project.appspot.com/o/file.jpg?alt=media&token=..." recommendation="In Firebase Storage, click the file, then copy the full 'Download URL' from the 'File location' panel. It must start with `https://firebasestorage.googleapis.com/...` and include an access token. A `gs://` link will not work." /><button onClick={() => addLogo('brand')} className={buttonClasses + " self-end"}>Add</button></div>
                 </AdminSection>
            </div>
        );
    };

    const EditingGuide = () => {
        const [playgroundText, setPlaygroundText] = useState('<b>Hello world!</b>\n\nTry editing me.\n<span class="text-brand-primary">I am using the brand primary color.</span>\n\nUse <br/> for line breaks.');
        return (
            <div className="space-y-8">
                <AdminSection title="Text Formatting Guide" gridCols="md:grid-cols-1">
                    <div className="prose prose-invert max-w-none text-text-secondary leading-relaxed">
                        <p>You can use basic HTML tags to format text in most multi-line text areas (like project descriptions or the 'About Me' intro). This allows for more dynamic content styling.</p>
                        <h4 className="text-lg font-bold text-text-primary">Commonly Used Tags:</h4>
                        <ul>
                            <li>For <strong>bold text</strong>, wrap your text in <code>&lt;b&gt;</code> tags. Example: <code>&lt;b&gt;Important&lt;/b&gt;</code></li>
                            <li>For <span className="text-brand-primary">brand-colored text</span>, use a span with a special class. Example: <code>&lt;span class="text-brand-primary"&gt;Highlight&lt;/span&gt;</code></li>
                            <li>For a line break,<br/>use the self-closing <code>&lt;br/&gt;</code> tag where you want the line to end.</li>
                        </ul>
                        <p>Feel free to experiment in the playground below to see how your text will look before saving it.</p>
                    </div>
                </AdminSection>
                <AdminSection title="Live Preview Playground" gridCols="md:grid-cols-1">
                    <AdminTextarea label="Enter your text with HTML here:" value={playgroundText} onChange={(e) => setPlaygroundText(e.target.value)} rows={8} />
                    <div>
                        <label className={labelClasses}>Live Preview:</label>
                        <div className="border border-base-light rounded p-4 bg-base-dark min-h-[100px] text-text-secondary">
                            <p className="leading-relaxed" dangerouslySetInnerHTML={{ __html: playgroundText.replace(/\n/g, '<br/>') }} />
                        </div>
                    </div>
                </AdminSection>
            </div>
        );
    };
    
    const SEOOptimizer = () => {
        const { aboutMe, heroProjects, updateAboutMe } = useContent();
        const [isLoading, setIsLoading] = useState(false);
        const [result, setResult] = useState(null);
        const [seoTitle, setSeoTitle] = useState(aboutMe.seoTitle || '');
        const [seoDescription, setSeoDescription] = useState(aboutMe.seoDescription || '');

        const cleanHtml = (html) => {
            if (!html) return '';
            const doc = new DOMParser().parseFromString(html, 'text/html');
            return doc.body.textContent || "";
        };

        const analyzeContent = () => {
            setIsLoading(true);
            setResult(null);

            setTimeout(() => {
                let allText = [
                    aboutMe.name, aboutMe.title, cleanHtml(aboutMe.heroIntro), cleanHtml(aboutMe.introStatement),
                    ...aboutMe.philosophy.flatMap(p => [p.title, cleanHtml(p.text)])
                ].join(' ');

                heroProjects.forEach(p => {
                    allText += ` ${p.title} ${p.subtitle} ${(p.tags || []).join(' ')}`;
                    (p.contentBlocks || []).forEach(block => {
                        if (block.type === 'text' || block.type === 'textWithImages') {
                            allText += ` ${cleanHtml(block.data.heading)} ${cleanHtml(block.data.body)}`;
                        }
                    });
                });

                const words = allText.toLowerCase().replace(/[^a-z\s-]/g, '').split(/\s+/).filter(Boolean);
                const stopWords = new Set(['a', 'an', 'and', 'the', 'is', 'in', 'it', 'of', 'for', 'on', 'with', 'as', 'by', 'to', 'i', 'my', 'me', 'we', 'our', 'you', 'your']);
                const wordFreq = words.reduce((acc, word) => {
                    if (!stopWords.has(word) && word.length > 2) {
                        acc[word] = (acc[word] || 0) + 1;
                    }
                    return acc;
                }, {});

                const sortedKeywords = Object.entries(wordFreq).sort((a, b) => b[1] - a[1]).map(e => e[0]);
                const topKeywords = sortedKeywords.slice(0, 5);
                
                const generatedTitle = `${aboutMe.name} | ${aboutMe.title} | ${topKeywords.slice(0, 2).map(k => k.charAt(0).toUpperCase() + k.slice(1)).join(' & ')} Portfolio`;

                let generatedDescription = cleanHtml(aboutMe.introStatement);
                if (generatedDescription.length > 160) {
                    generatedDescription = generatedDescription.substring(0, 157) + '...';
                }

                setSeoTitle(generatedTitle);
                setSeoDescription(generatedDescription);

                const recommendations = [
                    "Review the generated Title and Meta Description, edit if necessary, then click 'Save SEO Settings'.",
                    "Review your project tags. They are important for defining the skills you want to be known for.",
                    "Ensure all images have descriptive SEO text via the other admin tabs. This is crucial for accessibility and image search.",
                    "The tool will now automatically add Open Graph (OG) and Twitter tags to your site's header when you save.",
                    "Periodically re-run this analysis after updating your content to keep your SEO strategy fresh."
                ];

                setResult({
                    keywords: sortedKeywords.slice(0, 15),
                    recommendations: recommendations,
                });
                setIsLoading(false);
            }, 1500);
        };
        
        const handleSave = () => {
          updateAboutMe({ ...aboutMe, seoTitle, seoDescription });
          alert('SEO Settings have been saved and applied!');
        };

        return (
            <div className="space-y-8">
                <AdminSection title="SEO & Metadata Optimizer" gridCols="md:grid-cols-1">
                    <p className="text-text-secondary leading-relaxed">
                        This tool analyzes all the text content from your 'About Me' and 'Projects' pages to generate SEO-friendly recommendations. Click the button below to start the analysis. The results will help you improve your site's visibility on search engines.
                    </p>
                    <div className="pt-2">
                        <button onClick={analyzeContent} className={buttonClasses} disabled={isLoading}>
                            {isLoading ? 'Analyzing...' : 'Analyze Site Content'}
                        </button>
                    </div>
                </AdminSection>

                {isLoading && (
                    <div className="flex items-center justify-center p-8 bg-base-medium rounded-lg">
                        <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span className="text-text-secondary">Performing analysis, please wait...</span>
                    </div>
                )}
                
                {result && (
                  <div className="animate-fade-in-up" style={{animationDuration: '500ms'}}>
                    <AdminSection title="Analysis Results" gridCols="md:grid-cols-1">
                        <AdminInput label="Generated Page Title" value={seoTitle} onChange={e => setSeoTitle(e.target.value)} />
                        <p className="text-xs text-text-tertiary -mt-4">Recommended length: 50-60 characters. Current: {seoTitle.length}</p>
                        
                        <AdminTextarea label="Generated Meta Description" value={seoDescription} onChange={e => setSeoDescription(e.target.value)} rows={4} />
                        <p className="text-xs text-text-tertiary -mt-4">Recommended length: 150-160 characters. Current: {seoDescription.length}</p>

                        <div>
                            <label className={labelClasses}>Top Keywords</label>
                            <div className="flex flex-wrap gap-2 p-3 bg-base-dark border border-base-light rounded">
                                {result.keywords.map(kw => <span key={kw} className="bg-base-light text-text-secondary text-xs font-medium px-2.5 py-1 rounded-full">{kw}</span>)}
                            </div>
                        </div>
                        <div className="pt-2">
                           <button onClick={handleSave} className={buttonClasses}>Save SEO Settings</button>
                        </div>
                    </AdminSection>
                    <AdminSection title="Actionable Recommendations" gridCols="md:grid-cols-1">
                        <ul className="list-disc list-inside space-y-2 text-text-secondary">
                          {result.recommendations.map((rec, i) => <li key={i}>{rec}</li>)}
                        </ul>
                    </AdminSection>
                  </div>
                )}
            </div>
        );
    };

    const DangerZone = () => (
        <div className="bg-red-900/20 border border-red-700 p-6 rounded-lg">
            <h2 className="text-2xl font-bold text-red-400 mb-4">Danger Zone</h2>
            <p className="text-red-300 mb-4">This will clear any content stored in your browser's local storage and revert to the default content. This action cannot be undone and does not affect data saved in Firebase.</p>
            <button onClick={() => {if(confirm('Are you sure you want to reset all local data to defaults?')) { resetToDefaults(); }}} className="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Reset Local Content</button>
        </div>
    );


    if (loading) return <div className="bg-base-dark text-text-primary min-h-screen flex items-center justify-center">Loading...</div>;
    if (!isFirebaseActive) return (<div className="bg-base-dark text-text-primary min-h-screen p-8"><div className="max-w-4xl mx-auto"><h1 className="text-3xl font-bold mb-4">Admin Panel</h1><div className="bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded relative" role="alert"><strong className="font-bold">Firebase Not Configured!</strong><span className="block sm:inline"> The admin panel is disabled because Firebase credentials are not set up.</span></div></div></div>);

    if (!isAuthenticated) return (
      <div className="bg-base-dark text-text-primary min-h-screen flex items-center justify-center"><div className="max-w-md w-full p-8 bg-base-medium rounded-lg shadow-2xl border border-base-light">
          <h2 className="text-2xl font-bold text-center mb-6 text-text-primary">Admin Login</h2>
          <form onSubmit={handleLogin}>
            <div className="mb-4"><label className={labelClasses} htmlFor="email">Email</label><input type="email" id="email" value={email} onChange={(e) => setEmail(e.target.value)} className={inputClasses} required /></div>
            <div className="mb-6"><label className={labelClasses} htmlFor="password">Password</label><input type="password" id="password" value={password} onChange={(e) => setPassword(e.target.value)} className={inputClasses} required /></div>
            {error && <p className="text-red-500 text-xs italic mb-4">{error}</p>}
            <div className="flex flex-col items-center justify-center">
              <button type="submit" className="w-full bg-brand-primary hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-colors">Sign In</button>
              <a href="#/" onClick={(e) => { e.preventDefault(); window.location.hash = '#/'; }} className="mt-4 text-sm text-text-tertiary hover:text-text-primary transition-colors">Cancel</a>
            </div>
          </form>
      </div></div>
    );

    return (
        <div className="bg-base-dark text-text-primary min-h-screen p-4 md:p-8">
            <div className="max-w-7xl mx-auto">
                <header className="flex justify-between items-center mb-8 pb-4 border-b border-base-light">
                    <h1 className="text-3xl font-bold">Content Management</h1>
                    <div className="flex items-center gap-4">
                        <a href="#/" onClick={(e) => { e.preventDefault(); window.location.hash = '#/'; }} className="bg-base-light hover:bg-base-medium text-text-primary font-bold py-2 px-4 rounded transition-colors">View Site</a>
                        <button onClick={handleLogout} className="bg-base-light hover:bg-base-medium text-text-primary font-bold py-2 px-4 rounded">Logout</button>
                    </div>
                </header>
                <nav className="flex justify-between items-end border-b border-base-light mb-8">
                    <div className="flex space-x-1 sm:space-x-2 overflow-x-auto">
                        <TabButton label="Projects" tabName="projects" />
                        <TabButton label="Theme & General" tabName="theme" />
                        <TabButton label="Home Page" tabName="home" />
                        <TabButton label="About Page" tabName="about" />
                        <TabButton label="Logos" tabName="logos" />
                        <TabButton label="SEO & Metadata" tabName="seo" />
                        <TabButton label="Editing Guide" tabName="editing" />
                    </div>
                    <div>
                        <TabButton label="Danger Zone" tabName="danger" danger={true} />
                    </div>
                </nav>
                <main>
                    {activeTab === 'theme' && <ThemeGeneralSettings />}
                    {activeTab === 'home' && <HomePageSettings />}
                    {activeTab === 'about' && <AboutPageSettings />}
                    {activeTab === 'projects' && <ProjectEditor />}
                    {activeTab === 'logos' && <LogoEditor />}
                    {activeTab === 'seo' && <SEOOptimizer />}
                    {activeTab === 'editing' && <EditingGuide />}
                    {activeTab === 'danger' && <DangerZone />}
                </main>
            </div>
        </div>
    );
};

const Footer = () => {
  const { aboutMe } = useContent();
  const setHoverState = useContext(CursorHoverDispatchContext);
  const handleAdminClick = (e) => { e.preventDefault(); window.location.hash = '#/admin'; };
  return (
    <footer className="bg-base-medium border-t border-base-light">
      <div className="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div className="flex flex-row justify-between items-start gap-4">
          <div className="text-text-tertiary text-xs">
            <p>&copy; {new Date().getFullYear()} David Gaines. All rights reserved.</p>
            <div className="mt-1">
              <a href="#/admin" onClick={handleAdminClick} className="text-base-medium hover:text-text-tertiary transition-colors">Admin</a>
            </div>
          </div>
          <div className="flex items-start gap-4">
             {(aboutMe.socialLinks || []).map((social, index) => (
                <a 
                  key={index} 
                  href={social.linkUrl} 
                  target="_blank" 
                  rel="noopener noreferrer" 
                  className="text-text-secondary hover:text-brand-primary transition-colors duration-300" 
                  onMouseEnter={() => setHoverState({ isHovering: true })} 
                  onMouseLeave={() => setHoverState({ isHovering: false })} 
                  aria-label={`Social media link ${index + 1}`}
                >
                  {social.iconUrl === 'linkedin' ? (
                    <LinkedInIcon className="w-6 h-6"/>
                  ) : (
                    <img src={social.iconUrl} alt="" className="w-6 h-6 object-contain" />
                  )}
                </a>
             ))}
          </div>
        </div>
      </div>
    </footer>
  );
};

// --- Inlined from App.tsx ---
const MainApp = () => {
  const { path } = useRouter();
  
  const renderPage = () => {
    if (path === '#/about') return <AboutPage />;
    if (path.startsWith('#/project/')) {
      const projectId = path.split('/')[2]?.split('?')[0] || '';
      return <CaseStudyDetailPage key={projectId} projectId={projectId} />;
    }
    return <HomePage />;
  };

  const isDetailPage = path.startsWith('#/project/');
  const isAboutPage = path === '#/about';
  const isLightBackground = isDetailPage || isAboutPage;

  return (
    <div className="min-h-screen flex flex-col bg-base-dark">
      <CustomCursor />
      <Header />
      <main className={`flex-grow ${isLightBackground ? 'bg-white' : ''}`}>{renderPage()}</main>
      <Footer />
    </div>
  );
};

const AppContent = () => {
  const { path } = useRouter();
  const isAdminPage = path === '#/admin';

  useEffect(() => {
    if (isAdminPage) {
      document.body.classList.remove('hide-cursor');
    } else {
      document.body.classList.add('hide-cursor');
    }
  }, [isAdminPage]);

  // Render both components but hide the inactive one. This ensures Tailwind's JIT compiler
  // sees all classes on initial page load, fixing styling issues with client-side routing.
  return (
    <>
      <div className={isAdminPage ? 'hidden' : ''}>
        <MainApp />
      </div>
      <div className={isAdminPage ? '' : 'hidden'}>
        <AdminPage />
      </div>
    </>
  );
};

const App = () => (
  <ContentProvider><AppContent /></ContentProvider>
);

// --- Inlined from components/ErrorBoundary.tsx ---
class ErrorBoundary extends React.Component {
  state = { hasError: false, error: null, errorInfo: null };
  static getDerivedStateFromError(error) { return { hasError: true, error, errorInfo: null }; }
  componentDidCatch(error, errorInfo) {
    this.setState({ error, errorInfo });
    console.error("Uncaught error:", error, errorInfo);
  }
  render() {
    if (this.state.hasError) {
      return (
        <div style={{ position: 'fixed', inset: '0', backgroundColor: '#0f172a', color: '#f8fafc', padding: '2rem', fontFamily: 'monospace', zIndex: 99999, overflow: 'auto', cursor: 'auto' }}>
          <h1 style={{ color: '#ef4444', fontSize: '1.5rem', marginBottom: '1rem' }}>Application Error</h1>
          <p style={{ color: '#fca5a5', marginBottom: '1rem' }}>Something went wrong.</p>
          <pre style={{ backgroundColor: '#1e293b', padding: '1rem', borderRadius: '0.5rem', whiteSpace: 'pre-wrap', wordBreak: 'break-all', color: '#cbd5e1' }}>
            <strong>Error:</strong> {this.state.error?.toString()}<br /><br />
            <strong>Stack Trace:</strong><br />
            {this.state.errorInfo?.componentStack || this.state.error?.stack}
          </pre>
        </div>
      );
    }
    return this.props.children;
  }
}

// --- Inlined from index.tsx ---
const showErrorOverlay = (message) => {
  const appRoot = document.getElementById('root');
  if (appRoot) appRoot.style.display = 'none';
  let overlay = document.getElementById('error-overlay');
  if (!overlay) {
    overlay = document.createElement('div');
    overlay.id = 'error-overlay';
    Object.assign(overlay.style, { position: 'fixed', inset: '0', backgroundColor: '#0f172a', color: '#f8fafc', padding: '2rem', fontFamily: 'monospace', zIndex: '99999', overflow: 'auto', cursor: 'auto' });
    document.body.appendChild(overlay);
  }
  overlay.innerHTML = `<h1 style="color: #ef4444; font-size: 1.5rem; margin-bottom: 1rem;">A critical error occurred</h1><p style="color: #fca5a5; margin-bottom: 1rem;">The application could not start.</p><pre style="background-color: #1e293b; padding: 1rem; border-radius: 0.5rem; white-space: pre-wrap; word-break: break-all; color: '#cbd5e1';">${message}</pre>`;
};
window.addEventListener('error', (event) => { showErrorOverlay(`Error: ${event.message}\nSource: ${event.filename}\nLine: ${event.lineno}, Col: ${event.colno}`); });
window.addEventListener('unhandledrejection', (event) => { let reason = event.reason; if (reason instanceof Error) { reason = `${reason.message}\n${reason.stack}`; } showErrorOverlay(`Unhandled Promise Rejection:\nReason: ${reason}`); });

const rootElement = document.getElementById('root');
if (!rootElement) {
  showErrorOverlay('Fatal Error: The root HTML element with ID "root" was not found.');
  throw new Error("Could not find root element to mount to");
}

const root = ReactDOM.createRoot(rootElement);
root.render(
  <React.StrictMode>
    <ErrorBoundary>
      <CursorHoverProvider><App /></CursorHoverProvider>
    </ErrorBoundary>
  </React.StrictMode>
);
    </script>
  </body>
</html>